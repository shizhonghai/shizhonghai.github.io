<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>我是瘦子</title>
  
  <link href="/atom.xml" rel="self"/>
  
  <link href="https://shizhonghai.github.io/"/>
  <updated>2020-09-24T07:06:48.989Z</updated>
  <id>https://shizhonghai.github.io/</id>
  
  <author>
    <name>I am a thin man</name>
    
  </author>
  
  <generator uri="http://hexo.io/">Hexo</generator>
  
  <entry>
    <title>Web Api 相关接口</title>
    <link href="https://shizhonghai.github.io/2020/09/24/javascript-html-element/"/>
    <id>https://shizhonghai.github.io/2020/09/24/javascript-html-element/</id>
    <published>2020-09-23T16:00:00.000Z</published>
    <updated>2020-09-24T07:06:48.989Z</updated>
    
    <content type="html"><![CDATA[<h1 id="HTMLElement"><a href="#HTMLElement" class="headerlink" title="HTMLElement"></a>HTMLElement</h1><h2 id="HTMLElement-offsetWidth"><a href="#HTMLElement-offsetWidth" class="headerlink" title="HTMLElement.offsetWidth"></a><code>HTMLElement.offsetWidth</code></h2><p>引自MDN：是一个只读属性，返回一个元素的布局宽度。一个典型的（译者注：各浏览器的offsetWidth可能有所不同）offsetWidth是测量包含元素的边框(border)、水平线上的内边距(padding)、竖直方向滚动条(scrollbar)（如果存在的话）、以及CSS设置的宽度(width)的值。</p>
<p>语法<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 返回元素的宽度（包括元素宽度、内边距和边框，不包括外边距）</span></span><br><span class="line"><span class="keyword">var</span> offsetWidth = element.offsetWidth;</span><br></pre></td></tr></table></figure></p>
<blockquote>
<p>这个属性将会 round(四舍五入)为一个整数。如果你想要一个fractional(小数)值,请使用 <code>element.getBoundingClientRect()</code></p>
</blockquote>
<a id="more"></a>
<hr>
<h2 id="HTMLElement-offsetHeight"><a href="#HTMLElement-offsetHeight" class="headerlink" title="HTMLElement.offsetHeight"></a><code>HTMLElement.offsetHeight</code></h2><p>引自MDN：是一个只读属性，它返回该元素的像素高度，高度包含该元素的垂直内边距和边框，且是一个整数。</p>
<p>语法<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 返回元素的高度（包括元素高度、内边距和边框，不包括外边距）</span></span><br><span class="line"><span class="keyword">var</span> offsetWidth = element.offsetHeight;</span><br></pre></td></tr></table></figure></p>
<blockquote>
<p>这个属性值会被四舍五入为整数值，如果你需要一个浮点数值，请用 <code>element.getBoundingClientRect()</code></p>
</blockquote>
<hr>
<h2 id="HTMLElement-clientWidth"><a href="#HTMLElement-clientWidth" class="headerlink" title="HTMLElement.clientWidth"></a><code>HTMLElement.clientWidth</code></h2><p>引自MDN：内联元素以及没有 CSS 样式的元素的 clientWidth 属性值为 0。Element.clientWidth 属性表示元素的内部宽度，以像素计。该属性包括内边距 padding，但不包括边框 border、外边距 margin 和垂直滚动条（如果有的话）。</p>
<p>语法<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 返回元素的宽度（包括元素宽度、内边距，不包括边框和外边距）和垂直滚动条（如果有的话）</span></span><br><span class="line"><span class="keyword">var</span> intElemClientWidth = element.clientWidth;</span><br></pre></td></tr></table></figure></p>
<p>示例<br><img src="/images/Dimensions-client.png" alt="Dimensions-client" title="Dimensions-client"></p>
<hr>
<h2 id="HTMLElement-clientHeight"><a href="#HTMLElement-clientHeight" class="headerlink" title="HTMLElement.clientHeight"></a><code>HTMLElement.clientHeight</code></h2><p>引自MDN：这个属性是只读属性，对于没有定义CSS或者内联布局盒子的元素为0，否则，它是元素内部的高度(单位像素)，包含内边距，但不包括水平滚动条、边框和外边距。<br>clientHeight 可以通过 CSS height + CSS padding - 水平滚动条高度 (如果存在)来计算.</p>
<p>语法<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 返回元素的高度（包括元素高度、内边距，不包括水平滚动条、边框和外边距）</span></span><br><span class="line"><span class="keyword">var</span> h = element.clientHeight;</span><br></pre></td></tr></table></figure></p>
<p>示例<br><img src="/images/Dimensions-client.png" alt="Dimensions-client" title="Dimensions-client"></p>
<hr>
]]></content>
    
    <summary type="html">
    
      &lt;h1 id=&quot;HTMLElement&quot;&gt;&lt;a href=&quot;#HTMLElement&quot; class=&quot;headerlink&quot; title=&quot;HTMLElement&quot;&gt;&lt;/a&gt;HTMLElement&lt;/h1&gt;&lt;h2 id=&quot;HTMLElement-offsetWidth&quot;&gt;&lt;a href=&quot;#HTMLElement-offsetWidth&quot; class=&quot;headerlink&quot; title=&quot;HTMLElement.offsetWidth&quot;&gt;&lt;/a&gt;&lt;code&gt;HTMLElement.offsetWidth&lt;/code&gt;&lt;/h2&gt;&lt;p&gt;引自MDN：是一个只读属性，返回一个元素的布局宽度。一个典型的（译者注：各浏览器的offsetWidth可能有所不同）offsetWidth是测量包含元素的边框(border)、水平线上的内边距(padding)、竖直方向滚动条(scrollbar)（如果存在的话）、以及CSS设置的宽度(width)的值。&lt;/p&gt;
&lt;p&gt;语法&lt;br&gt;&lt;figure class=&quot;highlight javascript&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;// 返回元素的宽度（包括元素宽度、内边距和边框，不包括外边距）&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;var&lt;/span&gt; offsetWidth = element.offsetWidth;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;这个属性将会 round(四舍五入)为一个整数。如果你想要一个fractional(小数)值,请使用 &lt;code&gt;element.getBoundingClientRect()&lt;/code&gt;&lt;/p&gt;
&lt;/blockquote&gt;
    
    </summary>
    
    
      <category term="HTMLElement" scheme="https://shizhonghai.github.io/tags/HTMLElement/"/>
    
  </entry>
  
  <entry>
    <title>JavaScript 中 new 一个对象的过程中发生了什么</title>
    <link href="https://shizhonghai.github.io/2020/09/16/javascript-new-object-happen/"/>
    <id>https://shizhonghai.github.io/2020/09/16/javascript-new-object-happen/</id>
    <published>2020-09-15T16:00:00.000Z</published>
    <updated>2020-09-16T10:04:30.735Z</updated>
    
    <content type="html"><![CDATA[<p>我们先创建一个简单的构造函数：<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Rocker</span>(<span class="params">name</span>)</span>&#123;</span><br><span class="line">  <span class="keyword">this</span>.name = name;</span><br><span class="line">&#125;;</span><br><span class="line">Rocker.prototype.getName = <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="keyword">this</span>.name;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>这是最简单不过的构造函数了，正常情况下，我们要生成他的一个实例，只需要：<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> someOne = <span class="keyword">new</span> Rocker(<span class="string">'Max'</span>)</span><br></pre></td></tr></table></figure></p>
<p>这样就实例化了一个对象，但是，实例化的过程是怎样的呢？</p>
<p>可能很多朋友在网上也看了很多文章，new的过程不就是三步吗？</p>
<ol>
<li>开辟一个块内存，创建一个空对象</li>
<li>执行构造函数，对这个空对象进行构造</li>
<li>给这个空对象添加proto属性</li>
</ol>
<p>Or </p>
<ol>
<li>创建一个空对象</li>
<li>把该对象关联到原始对象或者是构造函数</li>
<li>把新创建的空对象作为原始对象或者构造函数的上下文</li>
<li>如果原始对象或者构造函数有返回值且为对象，则返回该对象，否则返回新创建的对象</li>
</ol>
<p>没错，是这三步，但是你真的理解了吗？至少我第一次看挺懵逼的。好吧，最直观的方法就是，把创建一个对象的过程用代码体现出来，这样才能装逼嘛…<br>体验：让我们创建一个函数，来实现上面new操作符的功能：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> createObject = <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">  <span class="keyword">var</span> obj = <span class="keyword">new</span> <span class="built_in">Object</span>(),   <span class="comment">//(1)</span></span><br><span class="line">      Constructor = [].shift.call(<span class="built_in">arguments</span>);   <span class="comment">//(2)</span></span><br><span class="line">  obj.__proto__ = Constructor.prototype;    <span class="comment">//(3)</span></span><br><span class="line">  <span class="keyword">var</span> ret = Constructor.apply(obj, <span class="built_in">arguments</span>);    <span class="comment">//(4)</span></span><br><span class="line">  <span class="keyword">return</span> <span class="keyword">typeof</span> ret === <span class="string">'object'</span> ? ret : obj;   <span class="comment">//(5)</span></span><br><span class="line">&#125;;</span><br><span class="line"><span class="keyword">var</span> Freak = createObject(Rocker, <span class="string">'Freak'</span>);</span><br><span class="line"><span class="built_in">console</span>.log(Freak.name);  <span class="comment">//Freak</span></span><br><span class="line"><span class="built_in">console</span>.log(Freak.getName());  <span class="comment">//Freak</span></span><br><span class="line"><span class="built_in">console</span>.log(<span class="built_in">Object</span>.getPrototypeOf(Freak) === Rocker.prototype); <span class="comment">//true</span></span><br></pre></td></tr></table></figure>
<p>就是上面这几句代码，向你展现了一个实例被new出来的过程。</p>
<p>我们来简单分析一下吧，其实很清晰明了了。</p>
<p>在(1)处，我们创建了一个空对象（准确的说是克隆了Object.prototype对象）</p>
<p>接下来(2)取到构造函数，赋值给Constructor变量，也就是说Rocker构造函数变成Constructor的一个引用了</p>
<p>接着(3)把Constructor.prototype（也就是Rocker.prototype）赋值给(1)刚刚创建的obj的原型链，或者这么说，把obj的原型链指向Constructor的原型</p>
<p>(4)我们用apply改变this的指向，用obj代替Constructor构造函数内部的this，并把arguments作为参数传入（在第2步时已经用shift把第一个参数去除了），此时的ret已经是一个合格的实例了！</p>
<p>保险起见，我们(5)返回时判断ret是否是对象，如果不是就返回一个空对象（因为很多人真的不会按照规矩传参！！！）</p>
<p>这时候我们再外部调用这个函数试试，实时证明确实能达到new的效果。</p>
<p>再用getPrototypeOf方法测试一下，Freak的原型链真的指向Rocker的原型！</p>
<p>这就是实例被new出来的过程，你明了吗？</p>
<blockquote>
<p>转载：<a href="https://rockjins.js.org/2017/01/18/2017-01-18-new-object/" target="_blank" rel="noopener">Rockjins Blog</a></p>
</blockquote>
]]></content>
    
    <summary type="html">
    
      &lt;p&gt;我们先创建一个简单的构造函数：&lt;br&gt;&lt;figure class=&quot;highlight javascript&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;li
    
    </summary>
    
    
      <category term="JavaScript" scheme="https://shizhonghai.github.io/tags/JavaScript/"/>
    
  </entry>
  
  <entry>
    <title>Js 算法：两数之和</title>
    <link href="https://shizhonghai.github.io/2020/09/10/javascript-algorithm01/"/>
    <id>https://shizhonghai.github.io/2020/09/10/javascript-algorithm01/</id>
    <published>2020-09-09T16:00:00.000Z</published>
    <updated>2020-09-10T11:40:29.828Z</updated>
    
    <content type="html"><![CDATA[<p>给定一个整数数组 nums 和一个目标值 target，请你在该数组中找出和为目标值的那 两个 整数，并返回他们的数组下标。<br>你可以假设每种输入只会对应一个答案。但是，数组中同一个元素不能使用两遍。</p>
<h2 id="示例"><a href="#示例" class="headerlink" title="示例:"></a>示例:</h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">给定 nums = [<span class="number">2</span>, <span class="number">7</span>, <span class="number">11</span>, <span class="number">15</span>], target = <span class="number">9</span></span><br><span class="line"></span><br><span class="line">因为 nums[<span class="number">0</span>] + nums[<span class="number">1</span>] = <span class="number">2</span> + <span class="number">7</span> = <span class="number">9</span></span><br><span class="line">所以返回 [<span class="number">0</span>, <span class="number">1</span>]</span><br></pre></td></tr></table></figure>
<h2 id="解一："><a href="#解一：" class="headerlink" title="解一："></a>解一：</h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * @param &#123;number[]&#125; nums</span></span><br><span class="line"><span class="comment"> * @param &#123;number&#125; target</span></span><br><span class="line"><span class="comment"> * @return &#123;number[]&#125;</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">var</span> twoSum = <span class="function"><span class="keyword">function</span> (<span class="params">nums, target</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">const</span> _arr = [];</span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">let</span> i = <span class="number">0</span>; i &lt; nums.length; i++) &#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">let</span> j = i + <span class="number">1</span>; j &lt; nums.length; j++) &#123;</span><br><span class="line">      <span class="keyword">if</span> (nums[i] + nums[j] === target) &#123;</span><br><span class="line">        _arr.push(i, j);</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> _arr;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<h2 id="解二："><a href="#解二：" class="headerlink" title="解二："></a>解二：</h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * @param &#123;number[]&#125; nums</span></span><br><span class="line"><span class="comment"> * @param &#123;number&#125; target</span></span><br><span class="line"><span class="comment"> * @return &#123;number[]&#125;</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">var</span> twoSum = <span class="function"><span class="keyword">function</span> (<span class="params">nums, target</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">let</span> i = <span class="number">0</span>; i &lt; nums.length; i++) &#123;</span><br><span class="line">    <span class="keyword">let</span> arrIndex = nums.findIndex(<span class="function"><span class="params">v</span> =&gt;</span> v === target - nums[i])</span><br><span class="line">    <span class="keyword">if</span> (arrIndex !== <span class="number">-1</span> &amp;&amp; arrIndex !== i) &#123;</span><br><span class="line">      <span class="keyword">return</span> [i, arrIndex]</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<blockquote>
<p>转载：<a href="https://leetcode-cn.com/problems/two-sum" target="_blank" rel="noopener">https://leetcode-cn.com/problems/two-sum</a></p>
</blockquote>
]]></content>
    
    <summary type="html">
    
      &lt;p&gt;给定一个整数数组 nums 和一个目标值 target，请你在该数组中找出和为目标值的那 两个 整数，并返回他们的数组下标。&lt;br&gt;你可以假设每种输入只会对应一个答案。但是，数组中同一个元素不能使用两遍。&lt;/p&gt;
&lt;h2 id=&quot;示例&quot;&gt;&lt;a href=&quot;#示例&quot; clas
    
    </summary>
    
    
      <category term="JavaScript" scheme="https://shizhonghai.github.io/tags/JavaScript/"/>
    
  </entry>
  
  <entry>
    <title>Js 根据一个多维数组查询最大深度问题</title>
    <link href="https://shizhonghai.github.io/2020/08/14/javascript-depth-count/"/>
    <id>https://shizhonghai.github.io/2020/08/14/javascript-depth-count/</id>
    <published>2020-08-13T16:00:00.000Z</published>
    <updated>2020-08-21T03:02:35.634Z</updated>
    
    <content type="html"><![CDATA[<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">deep</span>(<span class="params">arr, count = <span class="number">0</span>, ttt = []</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">let</span> index <span class="keyword">in</span> arr) &#123;</span><br><span class="line">        <span class="keyword">if</span> (<span class="built_in">Array</span>.isArray(arr[index])) &#123;</span><br><span class="line">            count++</span><br><span class="line">            deep(arr[index], count, ttt)</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            ttt.push(count)</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//return Math.max.apply(null, ttt) + 1</span></span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">Math</span>.max(...ttt) + <span class="number">1</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> arr = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, [<span class="string">'n'</span>, <span class="string">'i'</span>, [<span class="string">'t'</span>, [<span class="string">'nihao'</span>]]], [<span class="string">'a'</span>, <span class="string">'b'</span>]]</span><br><span class="line"></span><br><span class="line"><span class="built_in">console</span>.log(deep(arr)) <span class="comment">// 4</span></span><br></pre></td></tr></table></figure>
]]></content>
    
    <summary type="html">
    
      &lt;figure class=&quot;highlight javascript&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span 
    
    </summary>
    
    
      <category term="JavaScript" scheme="https://shizhonghai.github.io/tags/JavaScript/"/>
    
  </entry>
  
  <entry>
    <title>Js 数组的深度递归搜索</title>
    <link href="https://shizhonghai.github.io/2020/08/14/javascript-depth-recursion/"/>
    <id>https://shizhonghai.github.io/2020/08/14/javascript-depth-recursion/</id>
    <published>2020-08-13T16:00:00.000Z</published>
    <updated>2020-08-14T06:29:57.283Z</updated>
    
    <content type="html"><![CDATA[<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> fuck = [&#123;<span class="string">"label"</span>: <span class="string">"占用道路问题"</span>, <span class="string">"value"</span>: <span class="number">31</span>, <span class="string">"children"</span>: [&#123;<span class="string">"label"</span>: <span class="string">"经营占道"</span>, <span class="string">"value"</span>: <span class="number">35</span>, <span class="string">"children"</span>: [&#123;<span class="string">"label"</span>: <span class="string">"店外经营占道"</span>, <span class="string">"value"</span>: <span class="number">40</span>, <span class="string">"children"</span>: <span class="literal">null</span> &#125;, &#123;<span class="string">"label"</span>: <span class="string">"流动摊贩占道"</span>, <span class="string">"value"</span>: <span class="number">41</span>, <span class="string">"children"</span>: <span class="literal">null</span> &#125; ] &#125;, &#123;<span class="string">"label"</span>: <span class="string">"垃圾占道"</span>, <span class="string">"value"</span>: <span class="number">36</span>, <span class="string">"children"</span>: [&#123;<span class="string">"label"</span>: <span class="string">"生活垃圾"</span>, <span class="string">"value"</span>: <span class="number">42</span>, <span class="string">"children"</span>: <span class="literal">null</span> &#125;, &#123;<span class="string">"label"</span>: <span class="string">"建筑垃圾"</span>, <span class="string">"value"</span>: <span class="number">43</span>, <span class="string">"children"</span>: <span class="literal">null</span> &#125;, &#123;<span class="string">"label"</span>: <span class="string">"工业垃圾"</span>, <span class="string">"value"</span>: <span class="number">44</span>, <span class="string">"children"</span>: <span class="literal">null</span> &#125; ] &#125;, &#123;<span class="string">"label"</span>: <span class="string">"车辆占道"</span>, <span class="string">"value"</span>: <span class="number">37</span>, <span class="string">"children"</span>: [&#123;<span class="string">"label"</span>: <span class="string">"机动车占道"</span>, <span class="string">"value"</span>: <span class="number">45</span>, <span class="string">"children"</span>: <span class="literal">null</span> &#125;, &#123;<span class="string">"label"</span>: <span class="string">"非机动车占道"</span>, <span class="string">"value"</span>: <span class="number">46</span>, <span class="string">"children"</span>: <span class="literal">null</span> &#125; ] &#125;, &#123;<span class="string">"label"</span>: <span class="string">"霸占车位"</span>, <span class="string">"value"</span>: <span class="number">38</span>, <span class="string">"children"</span>: [] &#125;, &#123;<span class="string">"label"</span>: <span class="string">"其他占道"</span>, <span class="string">"value"</span>: <span class="number">39</span>, <span class="string">"children"</span>: [] &#125; ]&#125;, &#123;<span class="string">"label"</span>: <span class="string">"“两违”问题"</span>, <span class="string">"value"</span>: <span class="number">32</span>, <span class="string">"children"</span>: [&#123;<span class="string">"label"</span>: <span class="string">"违法建筑"</span>, <span class="string">"value"</span>: <span class="number">58</span>, <span class="string">"children"</span>: [&#123;<span class="string">"label"</span>: <span class="string">"房屋违建"</span>, <span class="string">"value"</span>: <span class="number">61</span>, <span class="string">"children"</span>: <span class="literal">null</span> &#125;, &#123;<span class="string">"label"</span>: <span class="string">"小区违建"</span>, <span class="string">"value"</span>: <span class="number">62</span>, <span class="string">"children"</span>: <span class="literal">null</span> &#125;, &#123;<span class="string">"label"</span>: <span class="string">"违建棚架"</span>, <span class="string">"value"</span>: <span class="number">63</span>, <span class="string">"children"</span>: <span class="literal">null</span> &#125; ] &#125;, &#123;<span class="string">"label"</span>: <span class="string">"违法用地"</span>, <span class="string">"value"</span>: <span class="number">59</span>, <span class="string">"children"</span>: [] &#125;, &#123;<span class="string">"label"</span>: <span class="string">"其他违建"</span>, <span class="string">"value"</span>: <span class="number">60</span>, <span class="string">"children"</span>: [] &#125; ] &#125;, &#123;<span class="string">"label"</span>: <span class="string">"市容设施管理问题"</span>, <span class="string">"value"</span>: <span class="number">33</span>, <span class="string">"children"</span>: [&#123;<span class="string">"label"</span>: <span class="string">"道路损坏"</span>, <span class="string">"value"</span>: <span class="number">47</span>, <span class="string">"children"</span>: [] &#125;, &#123;<span class="string">"label"</span>: <span class="string">"垃圾桶损坏"</span>, <span class="string">"value"</span>: <span class="number">48</span>, <span class="string">"children"</span>: [] &#125;, &#123;<span class="string">"label"</span>: <span class="string">"下水道堵塞"</span>, <span class="string">"value"</span>: <span class="number">49</span>, <span class="string">"children"</span>: [] &#125;, &#123;<span class="string">"label"</span>: <span class="string">"井盖损坏"</span>, <span class="string">"value"</span>: <span class="number">50</span>, <span class="string">"children"</span>: [] &#125;, &#123;<span class="string">"label"</span>: <span class="string">"路灯损坏"</span>, <span class="string">"value"</span>: <span class="number">51</span>, <span class="string">"children"</span>: [] &#125;, &#123;<span class="string">"label"</span>: <span class="string">"树木修剪"</span>, <span class="string">"value"</span>: <span class="number">52</span>, <span class="string">"children"</span>: [] &#125;, &#123;<span class="string">"label"</span>: <span class="string">"水电气"</span>, <span class="string">"value"</span>: <span class="number">53</span>, <span class="string">"children"</span>: [] &#125;, &#123;<span class="string">"label"</span>: <span class="string">"户外广告牌"</span>, <span class="string">"value"</span>: <span class="number">54</span>, <span class="string">"children"</span>: [] &#125;, &#123;<span class="string">"label"</span>: <span class="string">"隔音屏损坏"</span>, <span class="string">"value"</span>: <span class="number">55</span>, <span class="string">"children"</span>: [] &#125;, &#123;<span class="string">"label"</span>: <span class="string">"洒水车问题"</span>, <span class="string">"value"</span>: <span class="number">56</span>, <span class="string">"children"</span>: [] &#125;, &#123;<span class="string">"label"</span>: <span class="string">"其他"</span>, <span class="string">"value"</span>: <span class="number">57</span>, <span class="string">"children"</span>: [] &#125; ] &#125;, &#123;<span class="string">"label"</span>: <span class="string">"其他问题"</span>, <span class="string">"value"</span>: <span class="number">34</span>, <span class="string">"children"</span>: [] &#125; ]</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 深度递归搜索</span></span><br><span class="line"><span class="comment"> * @param &#123;Array&#125; arr 你要搜索的数组</span></span><br><span class="line"><span class="comment"> * @param &#123;Function&#125; condition 回调函数，必须返回谓词，判断是否找到了。会传入(item, index, level)三个参数</span></span><br><span class="line"><span class="comment"> * @param &#123;String&#125; children 子数组的key</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">const</span> deepFind = <span class="function">(<span class="params">arr, condition, children</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="comment">// 即将返回的数组</span></span><br><span class="line">    <span class="keyword">let</span> main = []</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 用try方案方便直接中止所有递归的程序</span></span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">        <span class="comment">// 开始轮询</span></span><br><span class="line">        (<span class="function"><span class="keyword">function</span> <span class="title">poll</span>(<span class="params">arr, level</span>) </span>&#123;</span><br><span class="line">            <span class="comment">// 如果传入非数组</span></span><br><span class="line">            <span class="keyword">if</span> (!<span class="built_in">Array</span>.isArray(arr)) <span class="keyword">return</span></span><br><span class="line"></span><br><span class="line">            <span class="comment">// 遍历数组</span></span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">let</span> i = <span class="number">0</span>; i &lt; arr.length; i++) &#123;</span><br><span class="line">                <span class="comment">// 获取当前项</span></span><br><span class="line">                <span class="keyword">const</span> item = arr[i]</span><br><span class="line"></span><br><span class="line">                <span class="comment">// 先占位预设值</span></span><br><span class="line">                main[level] = item</span><br><span class="line"></span><br><span class="line">                <span class="comment">// 检验是否已经找到了</span></span><br><span class="line">                <span class="keyword">const</span> isFind = condition &amp;&amp; condition(item, i, level) || <span class="literal">false</span></span><br><span class="line"></span><br><span class="line">                <span class="comment">// 如果已经找到了</span></span><br><span class="line">                <span class="keyword">if</span> (isFind) &#123;</span><br><span class="line">                    <span class="comment">// 直接抛出错误中断所有轮询</span></span><br><span class="line">                    <span class="keyword">throw</span> <span class="built_in">Error</span></span><br><span class="line"></span><br><span class="line">                <span class="comment">// 如果存在children，那么深入递归</span></span><br><span class="line">                &#125; <span class="keyword">else</span> <span class="keyword">if</span> (children &amp;&amp; item[children] &amp;&amp; item[children].length) &#123;</span><br><span class="line">                    poll(item[children], level + <span class="number">1</span>)</span><br><span class="line"></span><br><span class="line">                <span class="comment">// 如果是最后一个且没有找到值，那么通过修改数组长度来删除当前项</span></span><br><span class="line">                &#125; <span class="keyword">else</span> <span class="keyword">if</span> (i === arr.length - <span class="number">1</span>) &#123;</span><br><span class="line">                   <span class="comment">// 删除占位预设值</span></span><br><span class="line">                   main.length = main.length - <span class="number">1</span></span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;)(arr, <span class="number">0</span>)</span><br><span class="line">    <span class="comment">// 使用try/catch是为了中止所有轮询中的任务</span></span><br><span class="line">    &#125; <span class="keyword">catch</span> (err) &#123;&#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 返回最终数组</span></span><br><span class="line">    <span class="keyword">return</span> main</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> resultArr = deepFind(fuck, (item, index, level) =&gt; item.value === <span class="number">63</span>, <span class="string">'children'</span>);</span><br><span class="line"><span class="built_in">console</span>.log(resultArr);  <span class="comment">// [&#123;…&#125;, &#123;…&#125;, &#123;…&#125;]</span></span><br><span class="line"><span class="built_in">console</span>.log(resultArr.map(<span class="function"><span class="params">_</span> =&gt;</span> _.value)); <span class="comment">// [32, 58, 63]</span></span><br></pre></td></tr></table></figure>
<a id="more"></a>
]]></content>
    
    <summary type="html">
    
      &lt;figure class=&quot;highlight javascript&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;18&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;19&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;20&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;21&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;22&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;23&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;24&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;25&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;26&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;27&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;28&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;29&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;30&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;31&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;32&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;33&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;34&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;35&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;36&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;37&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;38&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;39&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;40&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;41&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;42&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;43&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;44&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;45&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;46&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;47&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;48&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;49&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;50&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;51&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;52&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;53&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;54&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;55&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;56&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; fuck = [&amp;#123;&lt;span class=&quot;string&quot;&gt;&quot;label&quot;&lt;/span&gt;: &lt;span class=&quot;string&quot;&gt;&quot;占用道路问题&quot;&lt;/span&gt;, &lt;span class=&quot;string&quot;&gt;&quot;value&quot;&lt;/span&gt;: &lt;span class=&quot;number&quot;&gt;31&lt;/span&gt;, &lt;span class=&quot;string&quot;&gt;&quot;children&quot;&lt;/span&gt;: [&amp;#123;&lt;span class=&quot;string&quot;&gt;&quot;label&quot;&lt;/span&gt;: &lt;span class=&quot;string&quot;&gt;&quot;经营占道&quot;&lt;/span&gt;, &lt;span class=&quot;string&quot;&gt;&quot;value&quot;&lt;/span&gt;: &lt;span class=&quot;number&quot;&gt;35&lt;/span&gt;, &lt;span class=&quot;string&quot;&gt;&quot;children&quot;&lt;/span&gt;: [&amp;#123;&lt;span class=&quot;string&quot;&gt;&quot;label&quot;&lt;/span&gt;: &lt;span class=&quot;string&quot;&gt;&quot;店外经营占道&quot;&lt;/span&gt;, &lt;span class=&quot;string&quot;&gt;&quot;value&quot;&lt;/span&gt;: &lt;span class=&quot;number&quot;&gt;40&lt;/span&gt;, &lt;span class=&quot;string&quot;&gt;&quot;children&quot;&lt;/span&gt;: &lt;span class=&quot;literal&quot;&gt;null&lt;/span&gt; &amp;#125;, &amp;#123;&lt;span class=&quot;string&quot;&gt;&quot;label&quot;&lt;/span&gt;: &lt;span class=&quot;string&quot;&gt;&quot;流动摊贩占道&quot;&lt;/span&gt;, &lt;span class=&quot;string&quot;&gt;&quot;value&quot;&lt;/span&gt;: &lt;span class=&quot;number&quot;&gt;41&lt;/span&gt;, &lt;span class=&quot;string&quot;&gt;&quot;children&quot;&lt;/span&gt;: &lt;span class=&quot;literal&quot;&gt;null&lt;/span&gt; &amp;#125; ] &amp;#125;, &amp;#123;&lt;span class=&quot;string&quot;&gt;&quot;label&quot;&lt;/span&gt;: &lt;span class=&quot;string&quot;&gt;&quot;垃圾占道&quot;&lt;/span&gt;, &lt;span class=&quot;string&quot;&gt;&quot;value&quot;&lt;/span&gt;: &lt;span class=&quot;number&quot;&gt;36&lt;/span&gt;, &lt;span class=&quot;string&quot;&gt;&quot;children&quot;&lt;/span&gt;: [&amp;#123;&lt;span class=&quot;string&quot;&gt;&quot;label&quot;&lt;/span&gt;: &lt;span class=&quot;string&quot;&gt;&quot;生活垃圾&quot;&lt;/span&gt;, &lt;span class=&quot;string&quot;&gt;&quot;value&quot;&lt;/span&gt;: &lt;span class=&quot;number&quot;&gt;42&lt;/span&gt;, &lt;span class=&quot;string&quot;&gt;&quot;children&quot;&lt;/span&gt;: &lt;span class=&quot;literal&quot;&gt;null&lt;/span&gt; &amp;#125;, &amp;#123;&lt;span class=&quot;string&quot;&gt;&quot;label&quot;&lt;/span&gt;: &lt;span class=&quot;string&quot;&gt;&quot;建筑垃圾&quot;&lt;/span&gt;, &lt;span class=&quot;string&quot;&gt;&quot;value&quot;&lt;/span&gt;: &lt;span class=&quot;number&quot;&gt;43&lt;/span&gt;, &lt;span class=&quot;string&quot;&gt;&quot;children&quot;&lt;/span&gt;: &lt;span class=&quot;literal&quot;&gt;null&lt;/span&gt; &amp;#125;, &amp;#123;&lt;span class=&quot;string&quot;&gt;&quot;label&quot;&lt;/span&gt;: &lt;span class=&quot;string&quot;&gt;&quot;工业垃圾&quot;&lt;/span&gt;, &lt;span class=&quot;string&quot;&gt;&quot;value&quot;&lt;/span&gt;: &lt;span class=&quot;number&quot;&gt;44&lt;/span&gt;, &lt;span class=&quot;string&quot;&gt;&quot;children&quot;&lt;/span&gt;: &lt;span class=&quot;literal&quot;&gt;null&lt;/span&gt; &amp;#125; ] &amp;#125;, &amp;#123;&lt;span class=&quot;string&quot;&gt;&quot;label&quot;&lt;/span&gt;: &lt;span class=&quot;string&quot;&gt;&quot;车辆占道&quot;&lt;/span&gt;, &lt;span class=&quot;string&quot;&gt;&quot;value&quot;&lt;/span&gt;: &lt;span class=&quot;number&quot;&gt;37&lt;/span&gt;, &lt;span class=&quot;string&quot;&gt;&quot;children&quot;&lt;/span&gt;: [&amp;#123;&lt;span class=&quot;string&quot;&gt;&quot;label&quot;&lt;/span&gt;: &lt;span class=&quot;string&quot;&gt;&quot;机动车占道&quot;&lt;/span&gt;, &lt;span class=&quot;string&quot;&gt;&quot;value&quot;&lt;/span&gt;: &lt;span class=&quot;number&quot;&gt;45&lt;/span&gt;, &lt;span class=&quot;string&quot;&gt;&quot;children&quot;&lt;/span&gt;: &lt;span class=&quot;literal&quot;&gt;null&lt;/span&gt; &amp;#125;, &amp;#123;&lt;span class=&quot;string&quot;&gt;&quot;label&quot;&lt;/span&gt;: &lt;span class=&quot;string&quot;&gt;&quot;非机动车占道&quot;&lt;/span&gt;, &lt;span class=&quot;string&quot;&gt;&quot;value&quot;&lt;/span&gt;: &lt;span class=&quot;number&quot;&gt;46&lt;/span&gt;, &lt;span class=&quot;string&quot;&gt;&quot;children&quot;&lt;/span&gt;: &lt;span class=&quot;literal&quot;&gt;null&lt;/span&gt; &amp;#125; ] &amp;#125;, &amp;#123;&lt;span class=&quot;string&quot;&gt;&quot;label&quot;&lt;/span&gt;: &lt;span class=&quot;string&quot;&gt;&quot;霸占车位&quot;&lt;/span&gt;, &lt;span class=&quot;string&quot;&gt;&quot;value&quot;&lt;/span&gt;: &lt;span class=&quot;number&quot;&gt;38&lt;/span&gt;, &lt;span class=&quot;string&quot;&gt;&quot;children&quot;&lt;/span&gt;: [] &amp;#125;, &amp;#123;&lt;span class=&quot;string&quot;&gt;&quot;label&quot;&lt;/span&gt;: &lt;span class=&quot;string&quot;&gt;&quot;其他占道&quot;&lt;/span&gt;, &lt;span class=&quot;string&quot;&gt;&quot;value&quot;&lt;/span&gt;: &lt;span class=&quot;number&quot;&gt;39&lt;/span&gt;, &lt;span class=&quot;string&quot;&gt;&quot;children&quot;&lt;/span&gt;: [] &amp;#125; ]&amp;#125;, &amp;#123;&lt;span class=&quot;string&quot;&gt;&quot;label&quot;&lt;/span&gt;: &lt;span class=&quot;string&quot;&gt;&quot;“两违”问题&quot;&lt;/span&gt;, &lt;span class=&quot;string&quot;&gt;&quot;value&quot;&lt;/span&gt;: &lt;span class=&quot;number&quot;&gt;32&lt;/span&gt;, &lt;span class=&quot;string&quot;&gt;&quot;children&quot;&lt;/span&gt;: [&amp;#123;&lt;span class=&quot;string&quot;&gt;&quot;label&quot;&lt;/span&gt;: &lt;span class=&quot;string&quot;&gt;&quot;违法建筑&quot;&lt;/span&gt;, &lt;span class=&quot;string&quot;&gt;&quot;value&quot;&lt;/span&gt;: &lt;span class=&quot;number&quot;&gt;58&lt;/span&gt;, &lt;span class=&quot;string&quot;&gt;&quot;children&quot;&lt;/span&gt;: [&amp;#123;&lt;span class=&quot;string&quot;&gt;&quot;label&quot;&lt;/span&gt;: &lt;span class=&quot;string&quot;&gt;&quot;房屋违建&quot;&lt;/span&gt;, &lt;span class=&quot;string&quot;&gt;&quot;value&quot;&lt;/span&gt;: &lt;span class=&quot;number&quot;&gt;61&lt;/span&gt;, &lt;span class=&quot;string&quot;&gt;&quot;children&quot;&lt;/span&gt;: &lt;span class=&quot;literal&quot;&gt;null&lt;/span&gt; &amp;#125;, &amp;#123;&lt;span class=&quot;string&quot;&gt;&quot;label&quot;&lt;/span&gt;: &lt;span class=&quot;string&quot;&gt;&quot;小区违建&quot;&lt;/span&gt;, &lt;span class=&quot;string&quot;&gt;&quot;value&quot;&lt;/span&gt;: &lt;span class=&quot;number&quot;&gt;62&lt;/span&gt;, &lt;span class=&quot;string&quot;&gt;&quot;children&quot;&lt;/span&gt;: &lt;span class=&quot;literal&quot;&gt;null&lt;/span&gt; &amp;#125;, &amp;#123;&lt;span class=&quot;string&quot;&gt;&quot;label&quot;&lt;/span&gt;: &lt;span class=&quot;string&quot;&gt;&quot;违建棚架&quot;&lt;/span&gt;, &lt;span class=&quot;string&quot;&gt;&quot;value&quot;&lt;/span&gt;: &lt;span class=&quot;number&quot;&gt;63&lt;/span&gt;, &lt;span class=&quot;string&quot;&gt;&quot;children&quot;&lt;/span&gt;: &lt;span class=&quot;literal&quot;&gt;null&lt;/span&gt; &amp;#125; ] &amp;#125;, &amp;#123;&lt;span class=&quot;string&quot;&gt;&quot;label&quot;&lt;/span&gt;: &lt;span class=&quot;string&quot;&gt;&quot;违法用地&quot;&lt;/span&gt;, &lt;span class=&quot;string&quot;&gt;&quot;value&quot;&lt;/span&gt;: &lt;span class=&quot;number&quot;&gt;59&lt;/span&gt;, &lt;span class=&quot;string&quot;&gt;&quot;children&quot;&lt;/span&gt;: [] &amp;#125;, &amp;#123;&lt;span class=&quot;string&quot;&gt;&quot;label&quot;&lt;/span&gt;: &lt;span class=&quot;string&quot;&gt;&quot;其他违建&quot;&lt;/span&gt;, &lt;span class=&quot;string&quot;&gt;&quot;value&quot;&lt;/span&gt;: &lt;span class=&quot;number&quot;&gt;60&lt;/span&gt;, &lt;span class=&quot;string&quot;&gt;&quot;children&quot;&lt;/span&gt;: [] &amp;#125; ] &amp;#125;, &amp;#123;&lt;span class=&quot;string&quot;&gt;&quot;label&quot;&lt;/span&gt;: &lt;span class=&quot;string&quot;&gt;&quot;市容设施管理问题&quot;&lt;/span&gt;, &lt;span class=&quot;string&quot;&gt;&quot;value&quot;&lt;/span&gt;: &lt;span class=&quot;number&quot;&gt;33&lt;/span&gt;, &lt;span class=&quot;string&quot;&gt;&quot;children&quot;&lt;/span&gt;: [&amp;#123;&lt;span class=&quot;string&quot;&gt;&quot;label&quot;&lt;/span&gt;: &lt;span class=&quot;string&quot;&gt;&quot;道路损坏&quot;&lt;/span&gt;, &lt;span class=&quot;string&quot;&gt;&quot;value&quot;&lt;/span&gt;: &lt;span class=&quot;number&quot;&gt;47&lt;/span&gt;, &lt;span class=&quot;string&quot;&gt;&quot;children&quot;&lt;/span&gt;: [] &amp;#125;, &amp;#123;&lt;span class=&quot;string&quot;&gt;&quot;label&quot;&lt;/span&gt;: &lt;span class=&quot;string&quot;&gt;&quot;垃圾桶损坏&quot;&lt;/span&gt;, &lt;span class=&quot;string&quot;&gt;&quot;value&quot;&lt;/span&gt;: &lt;span class=&quot;number&quot;&gt;48&lt;/span&gt;, &lt;span class=&quot;string&quot;&gt;&quot;children&quot;&lt;/span&gt;: [] &amp;#125;, &amp;#123;&lt;span class=&quot;string&quot;&gt;&quot;label&quot;&lt;/span&gt;: &lt;span class=&quot;string&quot;&gt;&quot;下水道堵塞&quot;&lt;/span&gt;, &lt;span class=&quot;string&quot;&gt;&quot;value&quot;&lt;/span&gt;: &lt;span class=&quot;number&quot;&gt;49&lt;/span&gt;, &lt;span class=&quot;string&quot;&gt;&quot;children&quot;&lt;/span&gt;: [] &amp;#125;, &amp;#123;&lt;span class=&quot;string&quot;&gt;&quot;label&quot;&lt;/span&gt;: &lt;span class=&quot;string&quot;&gt;&quot;井盖损坏&quot;&lt;/span&gt;, &lt;span class=&quot;string&quot;&gt;&quot;value&quot;&lt;/span&gt;: &lt;span class=&quot;number&quot;&gt;50&lt;/span&gt;, &lt;span class=&quot;string&quot;&gt;&quot;children&quot;&lt;/span&gt;: [] &amp;#125;, &amp;#123;&lt;span class=&quot;string&quot;&gt;&quot;label&quot;&lt;/span&gt;: &lt;span class=&quot;string&quot;&gt;&quot;路灯损坏&quot;&lt;/span&gt;, &lt;span class=&quot;string&quot;&gt;&quot;value&quot;&lt;/span&gt;: &lt;span class=&quot;number&quot;&gt;51&lt;/span&gt;, &lt;span class=&quot;string&quot;&gt;&quot;children&quot;&lt;/span&gt;: [] &amp;#125;, &amp;#123;&lt;span class=&quot;string&quot;&gt;&quot;label&quot;&lt;/span&gt;: &lt;span class=&quot;string&quot;&gt;&quot;树木修剪&quot;&lt;/span&gt;, &lt;span class=&quot;string&quot;&gt;&quot;value&quot;&lt;/span&gt;: &lt;span class=&quot;number&quot;&gt;52&lt;/span&gt;, &lt;span class=&quot;string&quot;&gt;&quot;children&quot;&lt;/span&gt;: [] &amp;#125;, &amp;#123;&lt;span class=&quot;string&quot;&gt;&quot;label&quot;&lt;/span&gt;: &lt;span class=&quot;string&quot;&gt;&quot;水电气&quot;&lt;/span&gt;, &lt;span class=&quot;string&quot;&gt;&quot;value&quot;&lt;/span&gt;: &lt;span class=&quot;number&quot;&gt;53&lt;/span&gt;, &lt;span class=&quot;string&quot;&gt;&quot;children&quot;&lt;/span&gt;: [] &amp;#125;, &amp;#123;&lt;span class=&quot;string&quot;&gt;&quot;label&quot;&lt;/span&gt;: &lt;span class=&quot;string&quot;&gt;&quot;户外广告牌&quot;&lt;/span&gt;, &lt;span class=&quot;string&quot;&gt;&quot;value&quot;&lt;/span&gt;: &lt;span class=&quot;number&quot;&gt;54&lt;/span&gt;, &lt;span class=&quot;string&quot;&gt;&quot;children&quot;&lt;/span&gt;: [] &amp;#125;, &amp;#123;&lt;span class=&quot;string&quot;&gt;&quot;label&quot;&lt;/span&gt;: &lt;span class=&quot;string&quot;&gt;&quot;隔音屏损坏&quot;&lt;/span&gt;, &lt;span class=&quot;string&quot;&gt;&quot;value&quot;&lt;/span&gt;: &lt;span class=&quot;number&quot;&gt;55&lt;/span&gt;, &lt;span class=&quot;string&quot;&gt;&quot;children&quot;&lt;/span&gt;: [] &amp;#125;, &amp;#123;&lt;span class=&quot;string&quot;&gt;&quot;label&quot;&lt;/span&gt;: &lt;span class=&quot;string&quot;&gt;&quot;洒水车问题&quot;&lt;/span&gt;, &lt;span class=&quot;string&quot;&gt;&quot;value&quot;&lt;/span&gt;: &lt;span class=&quot;number&quot;&gt;56&lt;/span&gt;, &lt;span class=&quot;string&quot;&gt;&quot;children&quot;&lt;/span&gt;: [] &amp;#125;, &amp;#123;&lt;span class=&quot;string&quot;&gt;&quot;label&quot;&lt;/span&gt;: &lt;span class=&quot;string&quot;&gt;&quot;其他&quot;&lt;/span&gt;, &lt;span class=&quot;string&quot;&gt;&quot;value&quot;&lt;/span&gt;: &lt;span class=&quot;number&quot;&gt;57&lt;/span&gt;, &lt;span class=&quot;string&quot;&gt;&quot;children&quot;&lt;/span&gt;: [] &amp;#125; ] &amp;#125;, &amp;#123;&lt;span class=&quot;string&quot;&gt;&quot;label&quot;&lt;/span&gt;: &lt;span class=&quot;string&quot;&gt;&quot;其他问题&quot;&lt;/span&gt;, &lt;span class=&quot;string&quot;&gt;&quot;value&quot;&lt;/span&gt;: &lt;span class=&quot;number&quot;&gt;34&lt;/span&gt;, &lt;span class=&quot;string&quot;&gt;&quot;children&quot;&lt;/span&gt;: [] &amp;#125; ]&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;/**&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt; * 深度递归搜索&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt; * @param &amp;#123;Array&amp;#125; arr 你要搜索的数组&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt; * @param &amp;#123;Function&amp;#125; condition 回调函数，必须返回谓词，判断是否找到了。会传入(item, index, level)三个参数&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt; * @param &amp;#123;String&amp;#125; children 子数组的key&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt; */&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; deepFind = &lt;span class=&quot;function&quot;&gt;(&lt;span class=&quot;params&quot;&gt;arr, condition, children&lt;/span&gt;) =&amp;gt;&lt;/span&gt; &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;comment&quot;&gt;// 即将返回的数组&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;let&lt;/span&gt; main = []&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;comment&quot;&gt;// 用try方案方便直接中止所有递归的程序&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;try&lt;/span&gt; &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;comment&quot;&gt;// 开始轮询&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        (&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;function&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;poll&lt;/span&gt;(&lt;span class=&quot;params&quot;&gt;arr, level&lt;/span&gt;) &lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            &lt;span class=&quot;comment&quot;&gt;// 如果传入非数组&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; (!&lt;span class=&quot;built_in&quot;&gt;Array&lt;/span&gt;.isArray(arr)) &lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            &lt;span class=&quot;comment&quot;&gt;// 遍历数组&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            &lt;span class=&quot;keyword&quot;&gt;for&lt;/span&gt; (&lt;span class=&quot;keyword&quot;&gt;let&lt;/span&gt; i = &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;; i &amp;lt; arr.length; i++) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                &lt;span class=&quot;comment&quot;&gt;// 获取当前项&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                &lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; item = arr[i]&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                &lt;span class=&quot;comment&quot;&gt;// 先占位预设值&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                main[level] = item&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                &lt;span class=&quot;comment&quot;&gt;// 检验是否已经找到了&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                &lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; isFind = condition &amp;amp;&amp;amp; condition(item, i, level) || &lt;span class=&quot;literal&quot;&gt;false&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                &lt;span class=&quot;comment&quot;&gt;// 如果已经找到了&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; (isFind) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                    &lt;span class=&quot;comment&quot;&gt;// 直接抛出错误中断所有轮询&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                    &lt;span class=&quot;keyword&quot;&gt;throw&lt;/span&gt; &lt;span class=&quot;built_in&quot;&gt;Error&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                &lt;span class=&quot;comment&quot;&gt;// 如果存在children，那么深入递归&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                &amp;#125; &lt;span class=&quot;keyword&quot;&gt;else&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; (children &amp;amp;&amp;amp; item[children] &amp;amp;&amp;amp; item[children].length) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                    poll(item[children], level + &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                &lt;span class=&quot;comment&quot;&gt;// 如果是最后一个且没有找到值，那么通过修改数组长度来删除当前项&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                &amp;#125; &lt;span class=&quot;keyword&quot;&gt;else&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; (i === arr.length - &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                   &lt;span class=&quot;comment&quot;&gt;// 删除占位预设值&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                   main.length = main.length - &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &amp;#125;)(arr, &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;comment&quot;&gt;// 使用try/catch是为了中止所有轮询中的任务&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &amp;#125; &lt;span class=&quot;keyword&quot;&gt;catch&lt;/span&gt; (err) &amp;#123;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;comment&quot;&gt;// 返回最终数组&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; main&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;let&lt;/span&gt; resultArr = deepFind(fuck, (item, index, level) =&amp;gt; item.value === &lt;span class=&quot;number&quot;&gt;63&lt;/span&gt;, &lt;span class=&quot;string&quot;&gt;&#39;children&#39;&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;built_in&quot;&gt;console&lt;/span&gt;.log(resultArr);  &lt;span class=&quot;comment&quot;&gt;// [&amp;#123;…&amp;#125;, &amp;#123;…&amp;#125;, &amp;#123;…&amp;#125;]&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;built_in&quot;&gt;console&lt;/span&gt;.log(resultArr.map(&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;params&quot;&gt;_&lt;/span&gt; =&amp;gt;&lt;/span&gt; _.value)); &lt;span class=&quot;comment&quot;&gt;// [32, 58, 63]&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
    
    </summary>
    
    
      <category term="JavaScript" scheme="https://shizhonghai.github.io/tags/JavaScript/"/>
    
  </entry>
  
  <entry>
    <title>关于 ECharts canvas 层级太高 导致 tooltip 被遮盖</title>
    <link href="https://shizhonghai.github.io/2020/07/08/echart-tooltip/"/>
    <id>https://shizhonghai.github.io/2020/07/08/echart-tooltip/</id>
    <published>2020-07-07T16:00:00.000Z</published>
    <updated>2020-07-08T03:11:42.370Z</updated>
    
    <content type="html"><![CDATA[<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*核心代码*/</span></span><br><span class="line"><span class="selector-tag">canvas</span> &#123;</span><br><span class="line"> <span class="attribute">z-index</span>: -<span class="number">1</span>;        </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
]]></content>
    
    <summary type="html">
    
      &lt;figure class=&quot;highlight css&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;
    
    </summary>
    
    
      <category term="EChart" scheme="https://shizhonghai.github.io/tags/EChart/"/>
    
  </entry>
  
  <entry>
    <title>Sequelize 中 Model 的数据类型</title>
    <link href="https://shizhonghai.github.io/2020/05/27/sequelize-model-dataType/"/>
    <id>https://shizhonghai.github.io/2020/05/27/sequelize-model-dataType/</id>
    <published>2020-05-26T16:00:00.000Z</published>
    <updated>2020-05-27T03:49:42.128Z</updated>
    
    <content type="html"><![CDATA[<p>Sequelize 中 Model 的数据类型对应MySQL中的数据类型</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line">Sequelize.STRING                      // VARCHAR(255)                  类型：字符串 最大值： 65535个字符</span><br><span class="line">Sequelize.STRING(1234)                // VARCHAR(1234)                 类型：变长 最大值： 65535个字符</span><br><span class="line">Sequelize.TEXT                        // TEXT                          类型：字符串 最大值：65535个字符</span><br><span class="line">Sequelize.TEXT(&apos;tiny&apos;)                // TINYTEXT                      类型：字符串 最大值：255个字符</span><br><span class="line"></span><br><span class="line">Sequelize.INTEGER                     // INTEGER                       类型：整型 最大值：范围(-2147483648~2147483647)</span><br><span class="line">Sequelize.BIGINT                      // BIGINT                        类型：整型 最大值：范围(+-9.22*10的18次方)</span><br><span class="line">Sequelize.BIGINT(11)                  // BIGINT(11)                    类型：整型 最大值：范围(+-9.22*10的18次方)</span><br><span class="line"></span><br><span class="line">Sequelize.FLOAT                       // FLOAT                         类型：单精度浮点型  8位精度(4字节)</span><br><span class="line">Sequelize.FLOAT(11)                   // FLOAT(11)                     类型：单精度浮点型 8位精度(4字节)</span><br><span class="line">Sequelize.FLOAT(11, 12)               // FLOAT(11,12)                  类型：精度浮点型 8位精度(4字节) m总个数，d小数位</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">Sequelize.DOUBLE                      // DOUBLE                        类型：双精度浮点型 16位精度(8字节) </span><br><span class="line">Sequelize.DOUBLE(11)                  // DOUBLE(11)                    类型：双精度浮点型 16位精度(8字节) </span><br><span class="line">Sequelize.DOUBLE(11, 12)              // DOUBLE(11,12)                 类型：双精度浮点型 16位精度(8字节) m总个数，d小数位</span><br><span class="line"></span><br><span class="line">Sequelize.DECIMAL                     // DECIMAL                       类型：定点数型</span><br><span class="line">Sequelize.DECIMAL(10, 2)              // DECIMAL(10,2)                 类型：定点数型 参数m&lt;65 是总个数，d&lt;30且 d&lt;m 是小数位</span><br><span class="line"></span><br><span class="line">Sequelize.DATE                        // DATETIME                      类型：日期时间类型 范例：&apos;2009-05-12 02:31:44&apos;</span><br><span class="line">Sequelize.DATE(6)                     // DATETIME(6)    </span><br><span class="line">Sequelize.DATEONLY                    // DATE without time.</span><br><span class="line">Sequelize.BOOLEAN                     // TINYINT(1)                    类型：整型 范围(-128~127)</span><br><span class="line"></span><br><span class="line">Sequelize.ENUM(&apos;value 1&apos;, &apos;value 2&apos;)  // ENUM                          类型：枚举</span><br><span class="line"></span><br><span class="line">Sequelize.BLOB                        // BLOB                          类型：二进制数据</span><br><span class="line">Sequelize.BLOB(&apos;tiny&apos;)                // TINYBLOB                      类型：二进制数据</span><br></pre></td></tr></table></figure>
]]></content>
    
    <summary type="html">
    
      &lt;p&gt;Sequelize 中 Model 的数据类型对应MySQL中的数据类型&lt;/p&gt;
&lt;figure class=&quot;highlight plain&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;b
    
    </summary>
    
    
      <category term="Sequelize" scheme="https://shizhonghai.github.io/tags/Sequelize/"/>
    
  </entry>
  
  <entry>
    <title>关于 EChart 页面多个图表，改变窗体大小图表不渲染问题</title>
    <link href="https://shizhonghai.github.io/2020/04/14/echart-resize/"/>
    <id>https://shizhonghai.github.io/2020/04/14/echart-resize/</id>
    <published>2020-04-13T16:00:00.000Z</published>
    <updated>2020-04-14T03:58:12.090Z</updated>
    
    <content type="html"><![CDATA[<ul>
<li><p>1.图表宽度需设置成 100%</p>
</li>
<li><p>2.同页面多图表请用 <code>addEventListener</code> 方法监听窗体大小改变</p>
</li>
</ul>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 监听窗口变化 - 只刷新最后一个图表,后定义的会覆盖前面定义的，只有1个生效</span></span><br><span class="line"><span class="built_in">window</span>.onresize = <span class="function"><span class="params">()</span>=&gt;</span> &#123;</span><br><span class="line">    EChart.resize(); </span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 监听窗口变化 - 多个图表同时刷新</span></span><br><span class="line"><span class="built_in">window</span>.addEventListener(<span class="string">"resize"</span>, <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;                </span><br><span class="line">	EChart.resize();           </span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
]]></content>
    
    <summary type="html">
    
      &lt;ul&gt;
&lt;li&gt;&lt;p&gt;1.图表宽度需设置成 100%&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;2.同页面多图表请用 &lt;code&gt;addEventListener&lt;/code&gt; 方法监听窗体大小改变&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;figure class=&quot;highlight ja
    
    </summary>
    
    
      <category term="EChart" scheme="https://shizhonghai.github.io/tags/EChart/"/>
    
  </entry>
  
  <entry>
    <title>Js 数组扁平化</title>
    <link href="https://shizhonghai.github.io/2020/04/13/javascript-arrary/"/>
    <id>https://shizhonghai.github.io/2020/04/13/javascript-arrary/</id>
    <published>2020-04-12T16:00:00.000Z</published>
    <updated>2020-04-13T11:58:40.897Z</updated>
    
    <content type="html"><![CDATA[<p>问题：[[0, 1], [2, 3], [4, 5]] -&gt; [0, 1, 2, 3, 4, 5]？</p>
<h2 id="方法一"><a href="#方法一" class="headerlink" title="方法一"></a>方法一</h2><blockquote>
<p>利用 <code>es5</code> 的 <code>arr.reduce(callback[, initialValue])</code> 实现</p>
</blockquote>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> arr1 = [[<span class="number">0</span>, <span class="number">1</span>], [<span class="number">2</span>, <span class="number">3</span>], [<span class="number">4</span>, <span class="number">5</span>]];</span><br><span class="line"><span class="keyword">let</span> arr2 = arr1.reduce( <span class="function">(<span class="params">a, b</span>) =&gt;</span> a.concat(b) );</span><br><span class="line"><span class="comment">// arr2 [0, 1, 2, 3, 4, 5]</span></span><br></pre></td></tr></table></figure>
<a id="more"></a>
<h2 id="方法二"><a href="#方法二" class="headerlink" title="方法二"></a>方法二</h2><blockquote>
<p>多维数组</p>
</blockquote>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> arr = [[<span class="number">1</span>,<span class="number">2</span>],<span class="number">3</span>,[[[<span class="number">4</span>], <span class="number">5</span>]]]</span><br><span class="line"><span class="keyword">let</span>  flatten = <span class="function">(<span class="params">arr</span>) =&gt;</span> [].concat( ...arr.map(<span class="function"><span class="params">x</span> =&gt;</span> <span class="built_in">Array</span>.isArray(x) ? flatten(x) : x) )  </span><br><span class="line"><span class="keyword">let</span> arr2 = flatten(arr);</span><br><span class="line"><span class="built_in">console</span>.log(arr2)       <span class="comment">// arr2 [1, 2, 3, 4, 5]</span></span><br></pre></td></tr></table></figure>
<h2 id="方法三"><a href="#方法三" class="headerlink" title="方法三"></a>方法三</h2><blockquote>
<p>利用 <code>apply</code> 实现</p>
</blockquote>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> arr1 = [[<span class="number">0</span>, <span class="number">1</span>], [<span class="number">2</span>, <span class="number">3</span>], [<span class="number">4</span>, <span class="number">5</span>]];</span><br><span class="line"><span class="keyword">let</span> arr2 = [].concat.apply([], arr1);</span><br><span class="line"><span class="built_in">console</span>.log(arr2);      <span class="comment">// arr2 [0, 1, 2, 3, 4, 5]</span></span><br></pre></td></tr></table></figure>
<h2 id="方法四"><a href="#方法四" class="headerlink" title="方法四"></a>方法四</h2><blockquote>
<p>利用 ES 的最新语法，<code>Array.prototype.flat()</code>。缺点是，有兼容性问题。优点是非常简单。<br>  <code>flat()</code> 方法会按照一个可指定的深度递归遍历数组(默认值为1)，并将所有元素与遍历到的子数组中的元素合并为一个新数组返回。</p>
</blockquote>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> arr1 = [<span class="number">1</span>, <span class="number">2</span>, [<span class="number">3</span>, <span class="number">4</span>]];</span><br><span class="line"><span class="keyword">let</span> arr2 = arr1.flat();     <span class="comment">// arr2 [1, 2, 3, 4]</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> arr3 = [<span class="number">1</span>, <span class="number">2</span>, [<span class="number">3</span>, <span class="number">4</span>, [<span class="number">5</span>, <span class="number">6</span>]]];</span><br><span class="line"><span class="keyword">let</span> arr4 = arr3.flat();     <span class="comment">// arr4 [1, 2, 3, 4, [5, 6]]</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> arr5 = [<span class="number">1</span>, <span class="number">2</span>, [<span class="number">3</span>, <span class="number">4</span>, [<span class="number">5</span>, <span class="number">6</span>]]];</span><br><span class="line"><span class="keyword">let</span> arr6 = arr5.flat(<span class="number">2</span>);    <span class="comment">// arr6 [1, 2, 3, 4, 5, 6]</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 使用 Infinity，可展开任意深度的嵌套数组</span></span><br><span class="line"><span class="keyword">let</span> arrInfinity = [<span class="number">1</span>, <span class="number">2</span>, [<span class="number">3</span>, <span class="number">4</span>, [<span class="number">5</span>, <span class="number">6</span>, [<span class="number">7</span>, <span class="number">8</span>, [<span class="number">9</span>, <span class="number">10</span>]]]]];</span><br><span class="line"><span class="keyword">let</span> arr7 = arrInfinity.flat(<span class="literal">Infinity</span>);     <span class="comment">// arr7 [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// flat() 方法会移除数组中的空项，但 undefined、null 仍会保留</span></span><br><span class="line"><span class="keyword">let</span> arr8 = [<span class="number">1</span>, <span class="number">2</span>, , <span class="number">4</span>, <span class="number">5</span>];</span><br><span class="line"><span class="keyword">let</span> arr9 = arr8.flat();             <span class="comment">// arr9 [1, 2, 4, 5]</span></span><br></pre></td></tr></table></figure>
]]></content>
    
    <summary type="html">
    
      &lt;p&gt;问题：[[0, 1], [2, 3], [4, 5]] -&amp;gt; [0, 1, 2, 3, 4, 5]？&lt;/p&gt;
&lt;h2 id=&quot;方法一&quot;&gt;&lt;a href=&quot;#方法一&quot; class=&quot;headerlink&quot; title=&quot;方法一&quot;&gt;&lt;/a&gt;方法一&lt;/h2&gt;&lt;blockquote&gt;
&lt;p&gt;利用 &lt;code&gt;es5&lt;/code&gt; 的 &lt;code&gt;arr.reduce(callback[, initialValue])&lt;/code&gt; 实现&lt;/p&gt;
&lt;/blockquote&gt;
&lt;figure class=&quot;highlight javascript&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;let&lt;/span&gt; arr1 = [[&lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;], [&lt;span class=&quot;number&quot;&gt;2&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;3&lt;/span&gt;], [&lt;span class=&quot;number&quot;&gt;4&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;5&lt;/span&gt;]];&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;let&lt;/span&gt; arr2 = arr1.reduce( &lt;span class=&quot;function&quot;&gt;(&lt;span class=&quot;params&quot;&gt;a, b&lt;/span&gt;) =&amp;gt;&lt;/span&gt; a.concat(b) );&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;// arr2 [0, 1, 2, 3, 4, 5]&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
    
    </summary>
    
    
      <category term="JavaScript" scheme="https://shizhonghai.github.io/tags/JavaScript/"/>
    
  </entry>
  
  <entry>
    <title>Nginx 配置 https 并强制跳转 443 端口</title>
    <link href="https://shizhonghai.github.io/2020/04/02/nginx-config-https/"/>
    <id>https://shizhonghai.github.io/2020/04/02/nginx-config-https/</id>
    <published>2020-04-01T16:00:00.000Z</published>
    <updated>2020-04-02T05:40:29.040Z</updated>
    
    <content type="html"><![CDATA[<p>在Nginx/Tengine服务器上安装证书</p>
<h2 id="前提条件"><a href="#前提条件" class="headerlink" title="前提条件"></a>前提条件</h2><p>申请证书时需要选择 系统自动创建CSR。</p>
<h2 id="操作指南"><a href="#操作指南" class="headerlink" title="操作指南"></a>操作指南</h2><p>1.登录阿里云<a href="https://yundunnext.console.aliyun.com/?p=casnext#/overview/cn-hangzhou" target="_blank" rel="noopener">SSL证书控制台</a>。</p>
<p>2.在SSL证书页面定位到需要下载的证书(如没有证书，请先购买)，并单击下载按钮<br><img src="/images/nginx-2020-04-02_11-37-31.png" alt="nginx https 配置1" title="nginx https 配置1"></p>
<a id="more"></a>
<p>3.在证书下载侧页面中定位到 Nginx 服务器，并单击右侧操作栏的下载，将 Nginx 服务器证书压缩包下载到本地。<br><img src="/images/nginx-2020-04-02_11-45-45.png" alt="nginx https 配置2" title="nginx https 配置2"></p>
<p>4.解压已下载保存到本地的 Nginx 证书压缩包文件。<br>解压后的文件夹中有2个文件：</p>
<ul>
<li>证书文件：以.pem为后缀或文件类型。</li>
<li>密钥文件：以.key为后缀或文件类型。</li>
</ul>
<p><img src="/images/nginx-2020-04-02_11-52-32.png" alt="nginx https 配置3" title="nginx https 配置3"></p>
<p>5.登录您的 Nginx 服务器，在Nginx安装目录（默认Nginx安装目录为/usr/local/nginx/conf）下创建cert目录，并将下载的证书文件和密钥文件拷贝到cert目录中。</p>
<blockquote>
<p>说明 如果您在申请证书时选择手动创建CSR文件，请将对应的密钥文件放到cert目录中，并命名为domain name.key。</p>
</blockquote>
<p>6.修改Nginx安装目录/conf/nginx.conf文件。<br>   按照下文中注释内容修改nginx.conf文件：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"># 以下属性中以ssl开头的属性代表与证书配置有关，其他属性请根据自己的需要进行配置。</span><br><span class="line">server &#123;</span><br><span class="line">    listen 443 ssl;   #SSL协议访问端口号为443。此处如未添加ssl，可能会造成Nginx无法启动。</span><br><span class="line">    server_name localhost;  #将localhost修改为您证书绑定的域名，例如：www.example.com。</span><br><span class="line">    ssl_certificate ../cert/domain name.pem;   #将domain name.pem替换成您证书的文件名。</span><br><span class="line">    ssl_certificate_key ../cert/domain name.key;   #将domain name.key替换成您证书的密钥文件名。</span><br><span class="line">    ssl_session_timeout 5m;</span><br><span class="line">    ssl_ciphers ECDHE-RSA-AES128-GCM-SHA256:ECDHE:ECDH:AES:HIGH:!NULL:!aNULL:!MD5:!ADH:!RC4;  #使用此加密套件。</span><br><span class="line">    ssl_protocols TLSv1 TLSv1.1 TLSv1.2;   #使用该协议进行配置。</span><br><span class="line">    ssl_prefer_server_ciphers on;</span><br><span class="line">    # 以下配置主要做8086端口转发，具体配置请以实际项目为准   </span><br><span class="line">    location / &#123;</span><br><span class="line">        proxy_redirect off;</span><br><span class="line">        proxy_pass_request_headers on;</span><br><span class="line">        proxy_http_version 1.1; </span><br><span class="line">        proxy_set_header Upgrade $http_upgrade;</span><br><span class="line">        proxy_set_header Connection &quot;upgrade&quot;;</span><br><span class="line">        proxy_pass http://127.0.0.1:8086; </span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"># 80端口重定向到443端口</span><br><span class="line">server &#123;</span><br><span class="line">    listen 80;</span><br><span class="line">    server_name xxxx.com;   # 你的域名</span><br><span class="line">    rewrite ^(.*)$ https://$host$1 permanent;   # 把http的域名请求转成https</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">server &#123;</span><br><span class="line">    listen 443;</span><br><span class="line">    server_name xxx.com;</span><br><span class="line">    return 301 https://www.xxx.com$request_uri;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>7.保存nginx.conf文件后退出。<br>8.执行以下命令重启Nginx服务器。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">nginx -s stop</span><br><span class="line">nginx -s start</span><br></pre></td></tr></table></figure></p>
]]></content>
    
    <summary type="html">
    
      &lt;p&gt;在Nginx/Tengine服务器上安装证书&lt;/p&gt;
&lt;h2 id=&quot;前提条件&quot;&gt;&lt;a href=&quot;#前提条件&quot; class=&quot;headerlink&quot; title=&quot;前提条件&quot;&gt;&lt;/a&gt;前提条件&lt;/h2&gt;&lt;p&gt;申请证书时需要选择 系统自动创建CSR。&lt;/p&gt;
&lt;h2 id=&quot;操作指南&quot;&gt;&lt;a href=&quot;#操作指南&quot; class=&quot;headerlink&quot; title=&quot;操作指南&quot;&gt;&lt;/a&gt;操作指南&lt;/h2&gt;&lt;p&gt;1.登录阿里云&lt;a href=&quot;https://yundunnext.console.aliyun.com/?p=casnext#/overview/cn-hangzhou&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;SSL证书控制台&lt;/a&gt;。&lt;/p&gt;
&lt;p&gt;2.在SSL证书页面定位到需要下载的证书(如没有证书，请先购买)，并单击下载按钮&lt;br&gt;&lt;img src=&quot;/images/nginx-2020-04-02_11-37-31.png&quot; alt=&quot;nginx https 配置1&quot; title=&quot;nginx https 配置1&quot;&gt;&lt;/p&gt;
    
    </summary>
    
    
      <category term="Nginx" scheme="https://shizhonghai.github.io/tags/Nginx/"/>
    
  </entry>
  
  <entry>
    <title>WebStorm 如何识别 Webpack 中的别名</title>
    <link href="https://shizhonghai.github.io/2020/04/02/webstorm-webpack-config/"/>
    <id>https://shizhonghai.github.io/2020/04/02/webstorm-webpack-config/</id>
    <published>2020-04-01T16:00:00.000Z</published>
    <updated>2020-04-02T09:54:36.961Z</updated>
    
    <content type="html"><![CDATA[<p>例如：在webpack.base.config.js 文件中的别名配置<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">'use strict'</span></span><br><span class="line"><span class="keyword">const</span> path = <span class="built_in">require</span>(<span class="string">'path'</span>)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">resolve</span> (<span class="params">dir</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> path.join(__dirname, <span class="string">'.'</span>, dir)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="built_in">module</span>.exports = &#123;</span><br><span class="line">    context: path.resolve(__dirname, <span class="string">'./'</span>),</span><br><span class="line">    resolve: &#123;</span><br><span class="line">        extensions: [<span class="string">'.js'</span>, <span class="string">'.vue'</span>, <span class="string">'.json'</span>],</span><br><span class="line">        alias: &#123;</span><br><span class="line">            <span class="string">'@'</span>: resolve(<span class="string">'src'</span>),</span><br><span class="line">            <span class="string">'@views'</span>: resolve(<span class="string">'src/views'</span>),</span><br><span class="line">            <span class="string">'@components'</span>: resolve(<span class="string">'src/components'</span>),</span><br><span class="line">            <span class="string">'@core'</span>: resolve(<span class="string">'src/core'</span>),</span><br><span class="line">            <span class="string">'@utils'</span>: resolve(<span class="string">'src/utils'</span>)</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;,</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>WebStorm Windows setting：<br><code>File &gt; Settings &gt; Languages and Frameworks &gt;JavaScript | Webpack</code></p>
<p>WebStorm MacOS setting：</p>
<p><code>WebStorm | Preferences | Languages and Frameworks | JavaScript | Webpack</code></p>
<p>配置如下图：<br><img src="/images/webstorm-webpack-config.png" alt="WebStorm 配置" title="WebStorm 配置"></p>
]]></content>
    
    <summary type="html">
    
      &lt;p&gt;例如：在webpack.base.config.js 文件中的别名配置&lt;br&gt;&lt;figure class=&quot;highlight javascript&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span
    
    </summary>
    
    
      <category term="WebStorm" scheme="https://shizhonghai.github.io/tags/WebStorm/"/>
    
  </entry>
  
  <entry>
    <title>Linux 下安装 pm2 后找不到 pm2 命令解决方法</title>
    <link href="https://shizhonghai.github.io/2020/03/31/node-pm2/"/>
    <id>https://shizhonghai.github.io/2020/03/31/node-pm2/</id>
    <published>2020-03-30T16:00:00.000Z</published>
    <updated>2020-03-31T06:18:31.632Z</updated>
    
    <content type="html"><![CDATA[<p>今天安装pm2碰到一个问题，使用 <code>npm install pm2 -g</code> 安装完成时，找不到 pm2 命令：</p>
<p><img src="/images/pm2-01.png" alt="npm install pm2" title="npm install pm2"></p>
<p>在安装提示中可以看到 pm2 安装位置，此时我们只要使用以下命令将 pm2 放入系统路径下就可以了：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ln -s /usr/src/node-v12.13.0-linux-x64/bin/pm2 /usr/local/bin/</span><br></pre></td></tr></table></figure>
]]></content>
    
    <summary type="html">
    
      &lt;p&gt;今天安装pm2碰到一个问题，使用 &lt;code&gt;npm install pm2 -g&lt;/code&gt; 安装完成时，找不到 pm2 命令：&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;/images/pm2-01.png&quot; alt=&quot;npm install pm2&quot; title=&quot;npm 
    
    </summary>
    
    
      <category term="pm2" scheme="https://shizhonghai.github.io/tags/pm2/"/>
    
  </entry>
  
  <entry>
    <title>Webpack 优化总会让你不得不爱</title>
    <link href="https://shizhonghai.github.io/2020/03/02/webpack-optimization/"/>
    <id>https://shizhonghai.github.io/2020/03/02/webpack-optimization/</id>
    <published>2020-03-01T16:00:00.000Z</published>
    <updated>2020-03-03T05:59:53.951Z</updated>
    
    <content type="html"><![CDATA[<h2 id="加油"><a href="#加油" class="headerlink" title="加油"></a>加油</h2><p>在家的日子不能出去玩，不能出去吃，的确是很不开心的，不过也是真的增加了好多空闲时间</p>
<p>与其在家呆着无聊，不如安安静静的学习一下</p>
<p>疫情期间，不管怎样，心态不能崩，武汉加油，中国加油</p>
<p>闲言少叙，现在我们就开始一起学习吧</p>
<h2 id="优化是个好词"><a href="#优化是个好词" class="headerlink" title="优化是个好词"></a>优化是个好词</h2><p><strong>优化</strong>，就是加以改变或选择使优良，在工作当中是让提升效率的好办法。<br>当然，webpack 优化千千万，但我觉得这些就够了<br>首当其冲的，就是工作中那些用不到的样式，可能是由于历史遗留原因已经忘记哪些是没有使用的样式了，一一排查太过耗时费力了<br>于是，<code>purgecss-webpack-plugin</code> 和 <code>glob</code> 它俩就登场了，它的作用就是解决上面提到的问题，让我们来看看如何使用吧<br>插件千万个，安装第一步：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm i purgecss-webpack-plugin glob -D</span><br></pre></td></tr></table></figure>
<a id="more"></a>
<h3 id="去除无用的样式"><a href="#去除无用的样式" class="headerlink" title="去除无用的样式"></a>去除无用的样式</h3><p>工欲善其事必先利其器，装备好了，我们也来看一眼实际的情况，然后再进行有效的配置吧<br><img src="/images/webpack-01.jpg" alt="webpack 配置" title="webpack 配置"><br>上图中就有一个没有被使用到的类名logo，所以如果在打包抽离出来的css文件里，肯定是不希望看到它的<br>那么，不废话，解决它，我们开始配置吧</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// webpack.config.js文件</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> path = <span class="built_in">require</span>(<span class="string">'path'</span>);</span><br><span class="line"><span class="comment">// html模板</span></span><br><span class="line"><span class="keyword">const</span> HtmlWebpackPlugin = <span class="built_in">require</span>(<span class="string">'html-webpack-plugin'</span>);</span><br><span class="line"><span class="comment">// 从js中抽离出css</span></span><br><span class="line"><span class="keyword">const</span> MiniCssExtractPlugin = <span class="built_in">require</span>(<span class="string">'mini-css-extract-plugin'</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 去除无用的样式</span></span><br><span class="line"><span class="keyword">const</span> glob = <span class="built_in">require</span>(<span class="string">'glob'</span>);</span><br><span class="line"><span class="keyword">const</span> PurgecssWebpackPlugin = <span class="built_in">require</span>(<span class="string">'purgecss-webpack-plugin'</span>);</span><br><span class="line"></span><br><span class="line"><span class="built_in">module</span>.exports = &#123;</span><br><span class="line">    entry: <span class="string">'./src/index.js'</span>,</span><br><span class="line">    output: &#123;</span><br><span class="line">        filename: <span class="string">'bundle.js'</span>,</span><br><span class="line">        path: path.resolve(<span class="string">'dist'</span>)</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="built_in">module</span>: &#123;</span><br><span class="line">        rules: [</span><br><span class="line">            &#123;</span><br><span class="line">                test: <span class="regexp">/\.js$/</span>,</span><br><span class="line">                use: &#123;</span><br><span class="line">                    loader: <span class="string">'babel-loader'</span></span><br><span class="line">                &#125;</span><br><span class="line">            &#125;,</span><br><span class="line">            &#123;   </span><br><span class="line">                test: <span class="regexp">/\.css$/</span>,</span><br><span class="line">                use: [MiniCssExtractPlugin.loader, <span class="string">'css-loader'</span>]</span><br><span class="line">            &#125;</span><br><span class="line">        ]</span><br><span class="line">    &#125;,</span><br><span class="line">    plugins: [</span><br><span class="line">        <span class="keyword">new</span> HtmlWebpaclPlugin(&#123;</span><br><span class="line">            template: <span class="string">'./src/index.html'</span></span><br><span class="line">        &#125;),</span><br><span class="line">        <span class="keyword">new</span> MiniCssExtractPlugin(),</span><br><span class="line">        <span class="comment">// 去除无用的样式</span></span><br><span class="line">        <span class="keyword">new</span> PurgecssWebpackPlugin(&#123;</span><br><span class="line">            paths: glob.sync(<span class="string">'./src/**/*'</span>, &#123;<span class="attr">nodir</span>: <span class="literal">true</span>&#125;)</span><br><span class="line">        &#125;)</span><br><span class="line">    ]</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<p>配置完毕了，上面包含了一些基本的配置。大家可以把重点放在<strong>注释为去除无用的样式</strong>代码部分即可了</p>
<p>下面我们来简单分析分析：</p>
<ul>
<li><p>glob是用来查找文件的</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">glob.sync(<span class="string">'./src/**/*'</span>, &#123;<span class="attr">nodir</span>: <span class="literal">true</span>&#125;</span><br><span class="line"><span class="comment">// 同步查找src目录下的任意文件夹下的任意文件</span></span><br><span class="line"><span class="comment">// 返回一个数组，如['真实路径/src/css/style.css','真实路径/src/index.js',...]</span></span><br><span class="line"><span class="comment">// &#123;nodir: true&#125;表示不包含文件夹，加快查找速度</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>purgecss-webpack-plugin是去除无用的css</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">new</span> PurgecssWebpackPlugin(&#123;</span><br><span class="line">    <span class="comment">// paths表示指定要去解析的文件名数组路径</span></span><br><span class="line">    <span class="comment">// Purgecss会去解析这些文件然后把无用的样式移除</span></span><br><span class="line">    paths: glob.sync(<span class="string">'./src/**/*'</span>, &#123;<span class="attr">nodir</span>: <span class="literal">true</span>&#125;)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
</li>
</ul>
<p><img src="/images/webpack-02.jpg" alt="webpack 配置2" title="webpack 配置2"></p>
<p>大功告成，进入下一环节！！！</p>
<h3 id="动态添加CDN"><a href="#动态添加CDN" class="headerlink" title="动态添加CDN"></a>动态添加CDN</h3><p>在 <code>html</code> 文件中引入cdn文件，在 webpack 配置 <code>externals</code>，这样就不会打包引入的cdn的库</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// index.html文件</span></span><br><span class="line"></span><br><span class="line">&lt;body&gt;</span><br><span class="line">    &lt;div id=<span class="string">"root"</span>&gt;&lt;/div&gt;</span><br><span class="line">    &lt;!-- 引入jquery的cdn --&gt;</span><br><span class="line">    &lt;script src=<span class="string">"https://cdn.bootcss.com/jquery/3.4.1/jquery.min.js"</span>&gt;&lt;/script&gt;</span><br><span class="line">&lt;<span class="regexp">/body&gt;</span></span><br><span class="line"><span class="regexp"></span></span><br><span class="line"><span class="regexp">/</span><span class="regexp">/ webpack.config.js文件</span></span><br><span class="line"><span class="regexp"></span></span><br><span class="line"><span class="regexp">module.exports = &#123;</span></span><br><span class="line"><span class="regexp">    externals: &#123;</span></span><br><span class="line"><span class="regexp">        'jquery': '$'</span></span><br><span class="line"><span class="regexp">    &#125;   </span></span><br><span class="line"><span class="regexp">&#125;</span></span><br></pre></td></tr></table></figure>
<p>这样写完后，在js文件中我们就可以不用再导入jquery也能直接使用$操作符了<br>But，这只是个过渡而已，下面有请主角登场<br>由于每次都需要在index.html模板中手动引入需要的cdn文件，然后还要在webpack里配置，有点繁琐了<br>So， <code>html-webpack-externals-plugin</code> 这样的插件就应运而生了<br>安装步骤我就略过了，直接看代码</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// webpack.config.js文件</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 动态添加CDN</span></span><br><span class="line"><span class="keyword">const</span> HtmlWebpackExternalsPlugin = <span class="built_in">require</span>(<span class="string">'html-webpack-externals-plugin'</span>);</span><br><span class="line"></span><br><span class="line"><span class="built_in">module</span>.exports = &#123;</span><br><span class="line">    plugins: [</span><br><span class="line">        <span class="keyword">new</span> HtmlWebpackExternalsPlugin(&#123;</span><br><span class="line">            externals: [</span><br><span class="line">                &#123;   <span class="comment">// 引入的模块</span></span><br><span class="line">                    <span class="built_in">module</span>: <span class="string">'jquery'</span>,</span><br><span class="line">                    <span class="comment">// cdn的地址</span></span><br><span class="line">                    entry: <span class="string">'https://cdn.bootcss.com/jquery/3.4.1/jquery.min.js'</span>,</span><br><span class="line">                    <span class="comment">// 挂载到了window上的名称</span></span><br><span class="line">                    <span class="comment">// window.jQuery就可以全局使用</span></span><br><span class="line">                    global: <span class="string">'jQuery'</span></span><br><span class="line">                &#125;,</span><br><span class="line">                &#123;</span><br><span class="line">                    <span class="built_in">module</span>: <span class="string">'vue'</span>,</span><br><span class="line">                    entry: <span class="string">'https://cdn.bootcss.com/vue/2.6.10/vue.min.js'</span>,</span><br><span class="line">                    global: <span class="string">'Vue'</span></span><br><span class="line">                &#125;</span><br><span class="line">            ]</span><br><span class="line">        &#125;)</span><br><span class="line">    ]</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<p><img src="/images/webpack-03.jpg" alt="webpack 配置3" title="webpack 配置3"></p>
<h3 id="Tree-shaking"><a href="#Tree-shaking" class="headerlink" title="Tree-shaking"></a>Tree-shaking</h3><p>这是一个webpack内置的优化能力，webpack很好很强大，哈哈<br>在生产环境下，Tree-shaking会进行自动删除的操作<br>如果通过ES6的import引用的方式就会把没有用到的代码给删除掉<br>那么在打包的时候，就不会打包那些未引用的方法了<br>接下来，我们看个栗子：<br>在src目录下新建一个common.js，然后在里面随便写点东东</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// src/common.js文件</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> flatten = <span class="function"><span class="params">arr</span> =&gt;</span> &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">'my-flatten'</span>);</span><br><span class="line">    <span class="keyword">return</span> arr.reduce(<span class="function">(<span class="params">all, cur</span>) =&gt;</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (<span class="built_in">Array</span>.isArray(cur) &#123;</span><br><span class="line">            <span class="keyword">return</span> [...all, ...flatten(cur)];</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="keyword">return</span> [...all, cur];</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;, []);</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> myBind = <span class="function">(<span class="params">fn, context</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">'my-bind'</span>);</span><br><span class="line">    <span class="keyword">let</span> args = [].slice.call(<span class="built_in">arguments</span>, <span class="number">2</span>);</span><br><span class="line">    <span class="keyword">return</span> <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">let</span> newArgs = [].slice.call(<span class="built_in">arguments</span>);</span><br><span class="line">        fn.apply(context, args.concat(newArgs));</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<p><code>import</code> 引用一下</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// index.js文件</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> &#123; flatten &#125; <span class="keyword">from</span> <span class="string">'./common'</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> arr = [<span class="number">1</span>,[<span class="number">3</span>,[<span class="number">4</span>, <span class="number">5</span>]], [<span class="number">2</span>, [<span class="number">20</span>]]];</span><br><span class="line"><span class="built_in">console</span>.log(flatten(arr));</span><br></pre></td></tr></table></figure>
<p><img src="/images/webpack-04.jpg" alt="webpack 配置4" title="webpack 配置4"><br>因为只在生产环境下有效果，可以去dist文件中检查一下，是没有 <code>console.log(&#39;my-bind&#39;)</code> 的代码的，这就说明完美的去掉了没有引用到的代码了<br>完美，完美，完美了</p>
<p>高兴的太早了，是药三分毒，有副作用的</p>
<p><strong>副作用</strong></p>
<p>现在我们在src目录再创建一个test.js文件，让大家再感受一下副作用</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// src/test.js文件</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> test = <span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">'test'</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">test();</span><br></pre></td></tr></table></figure>
<p>此时，简单修改一下index.js</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// index.js文件</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> &#123; flatten &#125; <span class="keyword">from</span> <span class="string">'./common'</span>;</span><br><span class="line"><span class="keyword">import</span> test <span class="keyword">from</span> <span class="string">'./test'</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> arr = [<span class="number">1</span>,[<span class="number">3</span>,[<span class="number">4</span>, <span class="number">5</span>]], [<span class="number">2</span>, [<span class="number">20</span>]]];</span><br><span class="line"><span class="built_in">console</span>.log(flatten(arr));</span><br></pre></td></tr></table></figure>
<p>尽管引入了test但是并没有使用，可是打包后的bundle.js文件却变化了，请看大屏幕<br><img src="/images/webpack-05.jpg" alt="webpack 配置5" title="webpack 配置5"></p>
<p>可想而知，<strong>副作用</strong>出现了，去dist目录下再看看bundle.js的内容，发现了打印test字段的代码。<br>肿么办？没引用却打包进去了，表慌，让我们来将文件标记为无副作用的<br>干掉副作用<br>需要配合 <code>package.json</code> 文件，在里面添加一个 <code>sideEffects</code> 属性，赋值为 <code>false</code> 就把这些<strong>副作用</strong>给干掉了不会再打包进去了，So Easy</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// package.json文件</span></span><br><span class="line">&#123;</span><br><span class="line">    ...省略</span><br><span class="line">    <span class="string">"sideEffects"</span>: <span class="literal">false</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><img src="/images/webpack-06.jpg" alt="webpack 配置6" title="webpack 配置6"></p>
<p>不过貌似，没有看到打包出来的css文件呢，回头看之前的截图，是打包出3个文件的，其中就包括 main.css<br>CSS去哪儿了？<br>很好理解，因为我们在js中引入css文件是 <code>import &#39;./style.css&#39;</code> 这样，所以就出现了副作用，引用却没使用的尴尬<br>也是因为 <code>sideEffects: false</code> 一股脑的全给标记过滤掉了<br>现在修改一下 <code>sideEffects</code> 的值就可以，给它一个去除副作用的范围</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// package.json文件</span></span><br><span class="line"></span><br><span class="line">&#123;</span><br><span class="line">    ...省略</span><br><span class="line">    <span class="string">"sideEffects"</span>: [<span class="string">"./src/**/*.css"</span>]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>过滤掉引入的css文件产生的副作用，这样走丢的css文件就又找回来了<br><img src="/images/webpack-07.jpg" alt="webpack 配置7" title="webpack 配置7"><br>至此，webpack内置的Tree-shaking就说完了，是不是很有意思，webpack大法好<br>下面一鼓作气继续说个内置的插件，非常实用，come on baby</p>
<h3 id="DllPlugin动态链接库"><a href="#DllPlugin动态链接库" class="headerlink" title="DllPlugin动态链接库"></a>DllPlugin动态链接库</h3><p>很多时候我们在开发时无论是用React还是Vue，我们都不希望这个开发的主力框架每次都被打包一遍，这样也是费时费力的事情<br>所以，出现了DllPlugin这种插件，它纯属webpack内置的，放心大胆的用<br>作用：</p>
<p>在第一次打包的时候就把打包用到的开发框架直接打包好，然后会生成一个 <code>manifest.json</code> 文件<br>再打包的时候，只要有 <code>import React from &#39;react&#39;</code> 这样的引用，它就会先去所谓的缓存文件里找，找到了就直接用，也不用再进行对react打包了<br>当然，如果没找到的话，再对框架打包一遍也无伤大雅</p>
<p>说多了，都是泪，看代码更实在，重写index.js</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// index.js文件</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> React <span class="keyword">from</span> <span class="string">'react'</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; render &#125; <span class="keyword">from</span> <span class="string">'react-dom'</span>;</span><br><span class="line"><span class="keyword">import</span> <span class="string">'./style.css'</span>;</span><br><span class="line"></span><br><span class="line">render(&lt;React.Fragment&gt;</span><br><span class="line">    &lt;h1 className="title"&gt;听妈妈的话-周杰伦&lt;/h1&gt;</span><br><span class="line">    &lt;button className="btn"&gt;显示歌词&lt;/button&gt;</span><br><span class="line">&lt;/React.Fragment&gt;, window.root);</span><br></pre></td></tr></table></figure>
<p>把index.js重写后我们再来npm run build打包一下看看<br><img src="/images/webpack-08.jpg" alt="webpack 配置8" title="webpack 配置8"></p>
<p>但是这很不科学，因为很多时候没有必要把开发框架也打包到我们写的逻辑代码中<br>所以，接下来我们来看看DllPlugin会帮我们怎么处理吧</p>
<h4 id="创建动态链接库"><a href="#创建动态链接库" class="headerlink" title="创建动态链接库"></a>创建动态链接库</h4><p>在<strong>根目录下</strong>创建一个 <code>webpack.dll.js</code> 文件，用来打包出dll文件</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// webpack.dll.js文件</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> path = <span class="built_in">require</span>(<span class="string">'path'</span>);</span><br><span class="line"><span class="comment">// 引入webpack</span></span><br><span class="line"><span class="keyword">const</span> webpack = <span class="built_in">require</span>(<span class="string">'webpack'</span>);</span><br><span class="line"></span><br><span class="line"><span class="built_in">module</span>.exports = &#123;</span><br><span class="line">    entry: [<span class="string">'react'</span>, <span class="string">'react-dom'</span>],</span><br><span class="line">    output: &#123;</span><br><span class="line">        filename: <span class="string">'react.dll.js'</span>,</span><br><span class="line">        path: path.resolve(<span class="string">'dll'</span>),</span><br><span class="line">        library: <span class="string">'react'</span>    <span class="comment">// 打包后被引用的变量名</span></span><br><span class="line">    &#125;,</span><br><span class="line">    plugins: [</span><br><span class="line">        <span class="comment">// 动态链接库</span></span><br><span class="line">        <span class="keyword">new</span> webpack.DllPlugin(&#123;</span><br><span class="line">            name: <span class="string">'react'</span>,</span><br><span class="line">            path: path.resolve(<span class="string">'dll'</span>, <span class="string">'manifest.json'</span>)</span><br><span class="line">        &#125;)</span><br><span class="line">    ]</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<p>代码写完了，<code>npm run dll</code>，之后会出现一个dll的文件夹，里面会包含你打包出来的文件，如下图<br><img src="/images/webpack-09.jpg" alt="webpack 配置9" title="webpack 配置9"><br>打包完成后，接下来轮到我们引用的时刻到了</p>
<h4 id="引用动态链接库"><a href="#引用动态链接库" class="headerlink" title="引用动态链接库"></a>引用动态链接库</h4><p>回到我们的主战场webpack.config.js中</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// webpack.config.js文件</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> path = <span class="built_in">require</span>(<span class="string">'path'</span>);</span><br><span class="line"><span class="comment">// 引入webpack</span></span><br><span class="line"><span class="keyword">const</span> webpack = <span class="built_in">require</span>(<span class="string">'webpack'</span>);</span><br><span class="line"></span><br><span class="line"><span class="built_in">module</span>.exports = &#123;</span><br><span class="line">    plugins: [</span><br><span class="line">        <span class="comment">// 引用对应的动态链接库的manifest.json文件</span></span><br><span class="line">        <span class="comment">// 这样以后再引入react的时候就会优先在json文件里去寻找</span></span><br><span class="line">        <span class="keyword">new</span> webpack.DllReferencePlugin(&#123;</span><br><span class="line">            manifest: path.resolve(<span class="string">'dll'</span>, <span class="string">'manifest.json'</span>)</span><br><span class="line">        &#125;)</span><br><span class="line">    ]</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<p>写到这里还不算完，还需要在src目录下的index.html模板中引入一下<br><code>&lt;script src=&quot;../dll/react.dll.js&quot;&gt;&lt;/script&gt;</code><br>插一句：之所以，会新建一个dll目录，因为在 <code>npm run dev</code> 开发环境编译的时候，dist目录的内容都在内存中了，是找不到react.dll.js文件的<br>好了，现在让我们看看效果吧，<code>npm run dev</code> 启动一下<br><img src="/images/webpack-10.jpg" alt="webpack 配置10" title="webpack 配置10"></p>
<p>当然，也许有人会问，如果需要引入的文件比较多怎么办？<br>每次在index.html中手动引入毕竟不是长久之计，那么接下来就再看一个好东东</p>
<h4 id="动态引入js"><a href="#动态引入js" class="headerlink" title="动态引入js"></a>动态引入js</h4><p>通过 <code>add-asset-html-webpack-plugin</code> 插件就可以完成这样的需求，来看代码</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// webpack.config.js文件</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> webpack = <span class="built_in">require</span>(<span class="string">'webpack'</span>);</span><br><span class="line"><span class="comment">// 添加资源到html文件</span></span><br><span class="line"><span class="keyword">const</span> AddAssetHtmlWebpackPlugin = <span class="built_in">require</span>(<span class="string">'add-asset-html-webpack-plugin'</span>);</span><br><span class="line"></span><br><span class="line"><span class="built_in">module</span>.exports = &#123;</span><br><span class="line">    plugins: [</span><br><span class="line">        <span class="comment">// 引用打包好的react，不会打包到bundle里</span></span><br><span class="line">        <span class="keyword">new</span> webpack.DllReferencePlugin(&#123;</span><br><span class="line">            manifest: path.resolve(<span class="string">'dll'</span>, <span class="string">'manifest.json'</span>)</span><br><span class="line">        &#125;),</span><br><span class="line">        <span class="comment">// 直接将打包好的react.dll.js添加到html模板</span></span><br><span class="line">        <span class="keyword">new</span> AddAssetHtmlWebpackPlugin(&#123;</span><br><span class="line">            filepath: path.resolve(<span class="string">'dll'</span>, <span class="string">'react.dll.js'</span>)</span><br><span class="line">        &#125;)</span><br><span class="line">    ]</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<p>通过上面的改造后，就动态的把react.dll.js文件添加到html文件中了。</p>
<p>我们之前在index.html模板里手动引入js的那一行就可以删除掉了</p>
<h3 id="懒加载"><a href="#懒加载" class="headerlink" title="懒加载"></a>懒加载</h3><p>说到懒加载必然是一种很好的优化网页或应用的方式，那么在webpack中也是通过ES6的 <code>import()</code> 语法来引入的。<br>虽然这个 <code>import()</code> 语法目前还处在草案的第三阶段，不过并不影响大家对它的一致好评<br>用过Vue-Router的同学都知道，大家写的路由通过 <code>component: () =&gt; import()</code> 的方式，也是可以进行懒加载的<br>So，好饭不怕晚，早晚会成为正式一员的。下面还是用实际栗子演示一下吧</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// index.js文件</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="string">'./style.css'</span>;</span><br><span class="line"><span class="keyword">import</span> React <span class="keyword">from</span> <span class="string">'react'</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; render &#125; <span class="keyword">from</span> <span class="string">'react-dom'</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 写个辅助的类</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Music</span> <span class="keyword">extends</span> <span class="title">React</span>.<span class="title">Component</span> </span>&#123;</span><br><span class="line">    <span class="keyword">constructor</span>() &#123;</span><br><span class="line">        <span class="keyword">super</span>();</span><br><span class="line">        <span class="keyword">this</span>.state = &#123; <span class="attr">lrc</span>: [] &#125;;</span><br><span class="line">    &#125;</span><br><span class="line">    showLrc() &#123;</span><br><span class="line">        <span class="comment">// 通过ES6的import()方法实现了懒加载功能，实际上是利用了jsonp去动态导入了</span></span><br><span class="line">        <span class="keyword">import</span>(<span class="string">'./lrc'</span>).then(<span class="function"><span class="params">data</span> =&gt;</span> &#123;</span><br><span class="line">            <span class="keyword">let</span> lrc = data.default.split(<span class="string">'\n'</span>).filter(<span class="function"><span class="params">item</span> =&gt;</span> item !== <span class="string">''</span>);</span><br><span class="line">            <span class="keyword">this</span>.setState(&#123; lrc &#125;);</span><br><span class="line">        &#125;);</span><br><span class="line">    &#125;</span><br><span class="line">    render() &#123;</span><br><span class="line">        <span class="keyword">return</span> (</span><br><span class="line">            &lt;div&gt;</span><br><span class="line">                &lt;button className=<span class="string">"btn"</span> onClick=&#123;() =&gt; <span class="keyword">this</span>.showLrc()&#125;&gt;显示歌词&lt;<span class="regexp">/button&gt;</span></span><br><span class="line"><span class="regexp">                &lt;div className="lrc-box"&gt;</span></span><br><span class="line"><span class="regexp">                    &#123;this.state.lrc &amp;&amp; this.state.lrc.map((item, index) =&gt; (</span></span><br><span class="line"><span class="regexp">                        &lt;p className="lrc" key=&#123;index&#125;&gt;&#123;item&#125;&lt;/</span>p&gt;</span><br><span class="line">                    ))&#125;</span><br><span class="line">                &lt;<span class="regexp">/div&gt;</span></span><br><span class="line"><span class="regexp">            &lt;/</span>div&gt;      </span><br><span class="line">        )</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">render(&lt;React.Fragment&gt;</span><br><span class="line">    &lt;h1 className="title"&gt;听妈妈的话-周杰伦&lt;/h1&gt;</span><br><span class="line">    &lt;Music&gt;&lt;/Music&gt;</span><br><span class="line">&lt;/React.Fragment&gt;, window.root);</span><br></pre></td></tr></table></figure>
<p><code>npm run dev</code> 让我们看看是不是有了懒加载的效果<br><img src="/images/webpack-11.gif" alt="webpack 配置11" title="webpack 配置11"><br>通过上面的gif图可以看到，当点击显示歌词的时候，加载了一个0.bundle.js文件<br>这个文件就是我们通过懒加载导入的lrc.js文件，由此可见，懒加载功能验证成功，撒花</p>
<p>接下来再来个老生常谈的优化，请继续往下看，不要停</p>
<h3 id="抽取公共代码"><a href="#抽取公共代码" class="headerlink" title="抽取公共代码"></a>抽取公共代码</h3><p>开发的时候，经常会有不同的模块引用了同一个第三方包。<br>这里举个栗子，比如有两个js文件，一个是index.js另一个是lrc.js，它们都引用了著名的实用工具库lodash，代码如下下下</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// index.js文件</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> _ <span class="keyword">from</span> <span class="string">'lodash'</span>;</span><br><span class="line"><span class="built_in">console</span>.log(_.xor([<span class="number">2</span>, <span class="number">1</span>], [<span class="number">2</span>, <span class="number">3</span>]));</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">// lrc.js文件</span></span><br><span class="line"><span class="keyword">import</span> _ <span class="keyword">from</span> <span class="string">'lodash'</span>;</span><br><span class="line"><span class="built_in">console</span>.log(_.flatten([<span class="number">1</span>,[<span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>, [<span class="number">2</span>]]]));</span><br></pre></td></tr></table></figure>
<p>看完以上代码就明白了，他们的公共部分就是都引了lodash，这样会分别打包到他们所在的文件中去，这样打包的js文件就会很大了</p>
<p>所以，必须得把lodash提取出来，废话不多说，看招</p>
<h4 id="抽取第三方模块"><a href="#抽取第三方模块" class="headerlink" title="抽取第三方模块"></a>抽取第三方模块</h4><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// webpack.config.js文件</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">module</span>.exports = &#123;</span><br><span class="line">    optimization: &#123;</span><br><span class="line">        splitChunks: &#123;</span><br><span class="line">            cacheGroups: &#123;</span><br><span class="line">                vendor: &#123;</span><br><span class="line">                    chunks: <span class="string">'initial'</span>,</span><br><span class="line">                    minSize: <span class="number">0</span>,</span><br><span class="line">                    minChunks: <span class="number">2</span>,</span><br><span class="line">                    test: <span class="regexp">/node_modules/</span>,</span><br><span class="line">                    priority: <span class="number">1</span></span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<p>webpack4中自带了抽取公共代码的方法，通过optimization里的splitChunks来做到<br><img src="/images/webpack-12.jpg" alt="webpack 配置12" title="webpack 配置12"><br>抽离第三方模块有两点好处</p>
<ul>
<li>不会和业务逻辑打包在一起</li>
<li>增加缓存 304</li>
</ul>
<h4 id="抽取公共模块"><a href="#抽取公共模块" class="headerlink" title="抽取公共模块"></a>抽取公共模块</h4><p>当然了，项目中很多js文件不仅仅会引用第三方模块来开发，我们也会使用写好的公共模块，那么是不是也可以提取出来呢？</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// index.js文件</span></span><br><span class="line"><span class="keyword">import</span> &#123; flatten &#125; <span class="keyword">from</span> <span class="string">'./common'</span>;</span><br><span class="line"><span class="built_in">console</span>.log(<span class="string">'index'</span>,flatten([<span class="number">1</span>,[<span class="number">33</span>, <span class="number">4</span>, <span class="number">5</span>, [<span class="number">34</span>]]]));</span><br><span class="line"></span><br><span class="line"><span class="comment">// lrc.js文件</span></span><br><span class="line"><span class="keyword">import</span> &#123;flatten&#125; <span class="keyword">from</span> <span class="string">'./common'</span>;</span><br><span class="line"><span class="built_in">console</span>.log(flatten([<span class="number">1</span>,[<span class="number">33</span>, <span class="number">4</span>, <span class="number">5</span>, [<span class="number">34</span>]]]));</span><br></pre></td></tr></table></figure>
<p>上面在两个js文件中都引入了common.js中写好的flatten方法，既然它们都引用到了common.js，所以想当然的也可以把它抽取出来的</p>
<p>那么参照提取第三方代码的实现来写一下吧</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// webpack.config.js文件</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">module</span>.exports = &#123;</span><br><span class="line">    optimization: &#123;</span><br><span class="line">        splitChunks: &#123;</span><br><span class="line">            cacheGroups: &#123;</span><br><span class="line">                utils: &#123;</span><br><span class="line">                    chunks: <span class="string">'initial'</span>,</span><br><span class="line">                    minSize: <span class="number">0</span>,</span><br><span class="line">                    minChunks: <span class="number">2</span></span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<p><img src="/images/webpack-13.png" alt="webpack 配置13" title="webpack 配置13"><br>以上就是抽取公共代码部分了，到此为止了</p>
<h3 id="热更新"><a href="#热更新" class="headerlink" title="热更新"></a>热更新</h3><p>热更新对于开发来说可以说是非常高效的，而且webpack现在也自带插件支持热更新了</p>
<p>通过 <strong>devServer</strong> 来启动热更新</p>
<p>☆：devServer的使用需要在项目中提前安好 <strong>webpack-dev-server</strong></p>
<p>那么我们先来看看配置部分：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// webpack.config.js文件</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 引入webpack</span></span><br><span class="line"><span class="keyword">const</span> webpack = <span class="built_in">require</span>(<span class="string">'webpack'</span>);</span><br><span class="line"></span><br><span class="line"><span class="built_in">module</span>.exports = &#123;</span><br><span class="line">    devServer: &#123;</span><br><span class="line">        hot: <span class="literal">true</span>,  <span class="comment">// 启动热更新</span></span><br><span class="line">        port: <span class="number">8080</span>,</span><br><span class="line">        contentBase: <span class="string">'./dist'</span></span><br><span class="line">    &#125;,</span><br><span class="line">    plugins: [</span><br><span class="line">        <span class="comment">// webpack支持热更新插件</span></span><br><span class="line">        <span class="keyword">new</span> webpack.HotModuleReplacementPlugin(),</span><br><span class="line">        <span class="comment">// 打印更新了的文件路径</span></span><br><span class="line">        <span class="keyword">new</span> webpack.NamedModulesPlugin()</span><br><span class="line">    ]</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<p>热更新只适合在开发环境下来搞，所以配置好后，再执行 <code>npm run dev</code></p>
<p>现在让我们回到index.js文件里去，让我们感受一下</p>
<p>// index.js文件</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 热更新</span></span><br><span class="line"><span class="comment">// 在src目录下新创建了audio.js文件</span></span><br><span class="line"><span class="comment">// 需要导入这个文件，不然热更新失效</span></span><br><span class="line"><span class="keyword">import</span> audio <span class="keyword">from</span> <span class="string">'./audio'</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 检查是否支持热更新</span></span><br><span class="line"><span class="keyword">if</span> (<span class="built_in">module</span>.hot) &#123;</span><br><span class="line">    <span class="comment">// 接收热更新的模块</span></span><br><span class="line">    <span class="built_in">module</span>.hot.accept(<span class="string">'./audio.js'</span>, (path) =&gt; &#123;</span><br><span class="line">        <span class="built_in">console</span>.log(path);</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">'audio文件更新了'</span>);</span><br><span class="line">    &#125;);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>这样就完成了热更新操作，接收了audio.js文件，所以在audio.js文件内部如果进行修改保存后，会在控制台里展示对应的更新信息，如下图</p>
<p><img src="/images/webpack-14.jpg" alt="webpack 配置14" title="webpack 配置14"></p>
<p>热更新现在可是开发中的老朋友，很多IDE都配置了热更新操作，比如像Android Studio这样的编译器，通过热更新来加快编译速度<br>好了，不啰嗦了，下面还是干货满满的，Enjoy it</p>
<h3 id="跨域请求"><a href="#跨域请求" class="headerlink" title="跨域请求"></a>跨域请求</h3><p>严格意义上来讲，通过webpack来做跨域请求实际上也不能算在优化里。不过在开发中，这种跨域的情况还是很多的，了解了也不吃亏，一起看看吧</p>
<p>还是通过老朋友devServer来实现的，上代码</p>
<h4 id="第一种跨域方式"><a href="#第一种跨域方式" class="headerlink" title="第一种跨域方式"></a>第一种跨域方式</h4><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// webpack.config.js文件</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">module</span>.exports = &#123;</span><br><span class="line">    devServer: &#123;</span><br><span class="line">        proxy: &#123;</span><br><span class="line">            <span class="comment">// 可以这样写</span></span><br><span class="line">            <span class="comment">// '/api': 'http://localhost:3000',</span></span><br><span class="line">            <span class="comment">// 也可以这样写，多配置</span></span><br><span class="line">            <span class="string">'/api'</span>: &#123;</span><br><span class="line">                target: <span class="string">'http://localhost:3000'</span>,</span><br><span class="line">                pathRewrite: &#123;</span><br><span class="line">                    <span class="string">'^/api'</span>: <span class="string">''</span></span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<p>通过devServer提供的proxy属性，可以完成我们想要的跨域请求，下面看看参数都是干什么的</p>
<ul>
<li><p>target<br>指定要跨域请求的url<br>比如你请求/api/userInfo就会代理到<a href="http://localhost:3000/api/userInfo" target="_blank" rel="noopener">http://localhost:3000/api/userInfo</a></p>
</li>
<li><p>pathRewrite<br>顾名思义，重写路径<br>接口不可能都是/api开头的，所以如果遇到个接口是/getSongs<br>而不是/api/getSongs的接口地址，会把以/api重写改为空字符<br>最后就可以访问<a href="http://localhost:3000/getSongs" target="_blank" rel="noopener">http://localhost:3000/getSongs</a></p>
</li>
</ul>
<h4 id="第二种跨域方式"><a href="#第二种跨域方式" class="headerlink" title="第二种跨域方式"></a>第二种跨域方式</h4><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// webpack.config.js文件</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">module</span>.exports = &#123;</span><br><span class="line">    devServer: &#123;</span><br><span class="line">        <span class="comment">// 利用node来写</span></span><br><span class="line">        before(app) &#123;</span><br><span class="line">            <span class="comment">// 相当于直接写了后端的接口，哈哈</span></span><br><span class="line">            app.get(<span class="string">'/api/info'</span>, (req, res) =&gt; &#123;</span><br><span class="line">                res.json(&#123;</span><br><span class="line">                    nickname: <span class="string">'我滴个大榴莲啊'</span>,</span><br><span class="line">                    level: <span class="number">8</span>,</span><br><span class="line">                    src: <span class="string">'https://music.163.com/song/media/outer/url?id=1382794914.mp3'</span></span><br><span class="line">                &#125;);</span><br><span class="line">            &#125;);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<p>当然，以上两种方式大家知道即可了，第一种也是最普遍的实现方式，妈妈再也不用担心我的跨域问题了</p>
<h3 id="IgnorePlugin"><a href="#IgnorePlugin" class="headerlink" title="IgnorePlugin"></a>IgnorePlugin</h3><p>作用： <strong>忽略打包</strong>第三方模块指定的目录</p>
<p>为什么要忽略呢？ 通过下面的栗子来看一下</p>
<p>相信很多人应该或多或少的都听过moment这个时间库，不知道也没关系，我来演示一波</p>
<p>先安装moment： <code>npm i moment -S</code></p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// index.js文件</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 导入moment</span></span><br><span class="line"><span class="keyword">import</span> moment <span class="keyword">from</span> <span class="string">'moment'</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 设置中文</span></span><br><span class="line">moment.locale(<span class="string">'zh-cn'</span>);</span><br><span class="line"><span class="keyword">let</span> time = moment().endOf(<span class="string">'day'</span>).fromNow();</span><br><span class="line"></span><br><span class="line"><span class="built_in">window</span>.root.innerHTML += time;</span><br></pre></td></tr></table></figure>
<p><img src="/images/webpack-15.jpg" alt="webpack 配置15" title="webpack 配置15"></p>
<p>页面上展示的一点毛病都没有，不过如果看一下打包的情况就会发现有瑕疵了，你看<br><img src="/images/webpack-16.jpg" alt="webpack 配置16" title="webpack 配置16"></p>
<p>设置了中文，却把整个语言包都打包进去了，这样很不好<br>这是神马原因呢，其实是因为moment被导入的时候，附赠了整个locale语言包，这种买一赠一的行为就不用提现在代码世界了，吃不消了<br><img src="/images/webpack-17.jpg" alt="webpack 配置17" title="webpack 配置17"></p>
<p>我们需要用中文包，但是不想打包全部语言包，就让IgnorePlugin出马了</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// webpack.config.js文件</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> webpack = <span class="built_in">require</span>(<span class="string">'webpack'</span>);</span><br><span class="line"></span><br><span class="line"><span class="built_in">module</span>.exports = &#123;</span><br><span class="line">    plugins: [</span><br><span class="line">        <span class="comment">// 忽略moment目录下的locale文件夹</span></span><br><span class="line">        <span class="keyword">new</span> webpack.IgnorePlugin(<span class="regexp">/\.\/locale/</span>, /moment/)</span><br><span class="line">    ]</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<p>配置改写后，再回到index.js中单独导入中文语言包就好了</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// index.js文件</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 利用IgnorePlugin把只需要的语言包导入使用就可以了，省去了一下子打包整个语言包</span></span><br><span class="line"><span class="keyword">import</span> moment <span class="keyword">from</span> <span class="string">'moment'</span>;</span><br><span class="line"><span class="comment">// 单独导入中文语言包</span></span><br><span class="line"><span class="keyword">import</span> <span class="string">'moment/locale/zh-cn'</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> time = moment().endOf(<span class="string">'day'</span>).fromNow();</span><br><span class="line"></span><br><span class="line"><span class="built_in">window</span>.root.innerHTML += time;</span><br></pre></td></tr></table></figure>
<p>再重新 <code>npm run build</code> 打包后，体积瞬间减少了278k啊啊啊啊，下图显示<br><img src="/images/webpack-18.jpg" alt="webpack 配置18" title="webpack 配置18"></p>
<h3 id="noParse"><a href="#noParse" class="headerlink" title="noParse"></a>noParse</h3><p>noParse的作用是不去解析你所使用的第三方库中的<strong>依赖库</strong></p>
<p>废话不多说，直接上代码</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// webpack.config.js文件</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">module</span>.exports = &#123;</span><br><span class="line">    <span class="built_in">module</span>: &#123;</span><br><span class="line">        <span class="comment">// 不去解析jquery或lodash中的依赖库</span></span><br><span class="line">        noParse: <span class="regexp">/jquery|lodash/</span>,  </span><br><span class="line">        rules: [</span><br><span class="line">            &#123;</span><br><span class="line">                test: <span class="regexp">/\.js$/</span>,</span><br><span class="line">                use: &#123;</span><br><span class="line">                    loader: <span class="string">'babel-loader'</span></span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        ]</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>在工作中，忽略大型的库可以<strong>提高构建性能</strong>，可以从构建时间上看出来速度的提升，如上面代码中提到的jquery和lodash</p>
<h3 id="resolve"><a href="#resolve" class="headerlink" title="resolve"></a>resolve</h3><p>从这个英文就能看出来，它就是配置模块如何解析用的，配置太多也没必要一一介绍了，还是直接说重点写出常用的配置吧</p>
<p>resolve常用配置</p>
<ul>
<li>modules<br>指定解析第三方包的目录位置</li>
<li>alias<br>指定import导入时的别名，简化引入</li>
<li>extensions<br>自动解析确定好的扩展名<br>默认会把js和json当做扩展名</li>
</ul>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// webpack.config.js文件</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> &#123; resolve &#125; = <span class="built_in">require</span>(<span class="string">'path'</span>);</span><br><span class="line"></span><br><span class="line"><span class="built_in">module</span>.exports = &#123;</span><br><span class="line">    resolve: &#123;</span><br><span class="line">        modules: [resolve(<span class="string">'node_modules'</span>)],</span><br><span class="line">        alias: &#123;</span><br><span class="line">            Utils: resolve(__dirname, <span class="string">'src/utils/'</span>),</span><br><span class="line">            <span class="string">'@'</span>: resolve(__dirname, <span class="string">'src'</span>)</span><br><span class="line">        &#125;,</span><br><span class="line">        extensions: [<span class="string">'.js'</span>, <span class="string">'.css'</span>, <span class="string">'.json'</span>]</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>此刻，我们往src目录下创建一个utils文件夹，然后新建一个parse-url.js文件</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// src/utils/parse-url.js文件</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 就简单导出一下</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="string">'我是解析url的方法'</span>;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">// src/index.js文件</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> parseUrl <span class="keyword">from</span> <span class="string">'Utils/parse-url'</span>;</span><br><span class="line"></span><br><span class="line"><span class="built_in">console</span>.log(parseUrl); <span class="comment">// 打印：我是解析url的方法</span></span><br></pre></td></tr></table></figure>
<p>上面代码为我们展示了alias别名的效果，真的是很有用很方便的，哈哈</p>
<h3 id="include和exclude"><a href="#include和exclude" class="headerlink" title="include和exclude"></a>include和exclude</h3><ul>
<li>include: 包含指定目录下的文件解析</li>
<li>exclude: 排除指定目录不进行解析<br>二者使用一个即可了，想必这个优化的点大家并不陌生的，看眼代码吧</li>
</ul>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">module</span>.exports = &#123;</span><br><span class="line">    <span class="built_in">module</span>: &#123;</span><br><span class="line">        rules: [</span><br><span class="line">            &#123;</span><br><span class="line">                test: <span class="regexp">/\.js$/</span>,</span><br><span class="line">                use: &#123;</span><br><span class="line">                    loader: <span class="string">'babel-loader'</span></span><br><span class="line">                &#125;,</span><br><span class="line">                exculde: <span class="regexp">/node_modules/</span>,    <span class="comment">// 二选一</span></span><br><span class="line">                include: path.resolve(<span class="string">'src'</span>)    <span class="comment">// 二选一</span></span><br><span class="line">            &#125;</span><br><span class="line">        ]</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="happypack"><a href="#happypack" class="headerlink" title="happypack"></a>happypack</h3><p>webpack在Node环境下运行所以也是单线程操作，一件一件的去处理事情。这样很不nice，本着现在cpu都那么威猛的情况下，运用多核运算完全是小儿科的<br>于是乎，就有了happypack的用武之地了，它的作用就是可以实现<strong>多进程打包操作</strong><br>下面我们再来看下是如何配置的<br>配置前先来安装一下 <code>npm i happypack -D</code></p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// webpack.config.js文件</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> Happypack = <span class="built_in">require</span>(<span class="string">'happypack'</span>);</span><br><span class="line"></span><br><span class="line"><span class="built_in">module</span>.exports = &#123;</span><br><span class="line">    <span class="built_in">module</span>: &#123;</span><br><span class="line">        rules: [</span><br><span class="line">            &#123;</span><br><span class="line">                test: <span class="regexp">/\.js$/</span>,</span><br><span class="line">                use: <span class="string">'Happypack/loader?id=js'</span></span><br><span class="line">            &#125;,</span><br><span class="line">            &#123;</span><br><span class="line">                test: <span class="regexp">/\.css$/</span>,</span><br><span class="line">                use: <span class="string">'Happypack/loader?id=css'</span></span><br><span class="line">            &#125;</span><br><span class="line">        ]</span><br><span class="line">    &#125;,</span><br><span class="line">    plugins: [</span><br><span class="line">        <span class="keyword">new</span> Happypack(&#123;</span><br><span class="line">            id: <span class="string">'js'</span>,</span><br><span class="line">            use: [</span><br><span class="line">                &#123;</span><br><span class="line">                    loader: <span class="string">'babel-loader'</span>,</span><br><span class="line">                    options: &#123;</span><br><span class="line">                        presets: [</span><br><span class="line">                            <span class="string">'@babel/preset-env'</span>,</span><br><span class="line">                            <span class="string">'@babel/preset-react'</span></span><br><span class="line">                        ]</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">            ]</span><br><span class="line">        &#125;),</span><br><span class="line">        <span class="keyword">new</span> Happypack(&#123;</span><br><span class="line">            id: <span class="string">'css'</span>,</span><br><span class="line">            use: [<span class="string">'style-loader'</span>, <span class="string">'css-loader'</span>]</span><br><span class="line">        &#125;)</span><br><span class="line">    ]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>差不多了，大家真的辛苦了，哈哈，坚持看下来的小伙伴，真是太给力了</p>
<h2 id="简单几句"><a href="#简单几句" class="headerlink" title="简单几句"></a>简单几句</h2><p>优化的内容有多种多样，也不会全部都包含，上面提到的也都是比较常见的一些优化方式，各取所需、各取所用就好了</p>
<p>还是那句话，疫情总会过去的，没什么好怕的，一起努力吧！！！</p>
<p>感谢大家，886</p>
<blockquote>
<p>文章来源：<a href="https://juejin.im/post/5cceecb7e51d453ab908717c#heading-24" title="Webpack 优化总会让你不得不爱" target="_blank" rel="noopener">Webpack 优化总会让你不得不爱</a></p>
</blockquote>
]]></content>
    
    <summary type="html">
    
      &lt;h2 id=&quot;加油&quot;&gt;&lt;a href=&quot;#加油&quot; class=&quot;headerlink&quot; title=&quot;加油&quot;&gt;&lt;/a&gt;加油&lt;/h2&gt;&lt;p&gt;在家的日子不能出去玩，不能出去吃，的确是很不开心的，不过也是真的增加了好多空闲时间&lt;/p&gt;
&lt;p&gt;与其在家呆着无聊，不如安安静静的学习一下&lt;/p&gt;
&lt;p&gt;疫情期间，不管怎样，心态不能崩，武汉加油，中国加油&lt;/p&gt;
&lt;p&gt;闲言少叙，现在我们就开始一起学习吧&lt;/p&gt;
&lt;h2 id=&quot;优化是个好词&quot;&gt;&lt;a href=&quot;#优化是个好词&quot; class=&quot;headerlink&quot; title=&quot;优化是个好词&quot;&gt;&lt;/a&gt;优化是个好词&lt;/h2&gt;&lt;p&gt;&lt;strong&gt;优化&lt;/strong&gt;，就是加以改变或选择使优良，在工作当中是让提升效率的好办法。&lt;br&gt;当然，webpack 优化千千万，但我觉得这些就够了&lt;br&gt;首当其冲的，就是工作中那些用不到的样式，可能是由于历史遗留原因已经忘记哪些是没有使用的样式了，一一排查太过耗时费力了&lt;br&gt;于是，&lt;code&gt;purgecss-webpack-plugin&lt;/code&gt; 和 &lt;code&gt;glob&lt;/code&gt; 它俩就登场了，它的作用就是解决上面提到的问题，让我们来看看如何使用吧&lt;br&gt;插件千万个，安装第一步：&lt;/p&gt;
&lt;figure class=&quot;highlight plain&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;npm i purgecss-webpack-plugin glob -D&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
    
    </summary>
    
    
      <category term="Webpack" scheme="https://shizhonghai.github.io/tags/Webpack/"/>
    
  </entry>
  
  <entry>
    <title>lowdb</title>
    <link href="https://shizhonghai.github.io/2020/02/21/lowdb/"/>
    <id>https://shizhonghai.github.io/2020/02/21/lowdb/</id>
    <published>2020-02-20T16:00:00.000Z</published>
    <updated>2020-02-21T07:11:56.611Z</updated>
    
    <content type="html"><![CDATA[<p>NPM 源地址 ： <a href="https://www.npmjs.com/package/lowdb" target="_blank" rel="noopener">https://www.npmjs.com/package/lowdb</a></p>
<blockquote>
<p>用于Node，Electron和浏览器的小型JSON数据库。由Lodash提供技术支持</p>
</blockquote>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">db.get(<span class="string">'posts'</span>)</span><br><span class="line">  .push(&#123; <span class="attr">id</span>: <span class="number">1</span>, <span class="attr">title</span>: <span class="string">'lowdb is awesome'</span>&#125;)</span><br><span class="line">  .write()</span><br></pre></td></tr></table></figure>
<h2 id="用法"><a href="#用法" class="headerlink" title="用法"></a>用法</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install lowdb</span><br></pre></td></tr></table></figure>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> low = <span class="built_in">require</span>(<span class="string">'lowdb'</span>);</span><br><span class="line"><span class="keyword">const</span> FileSync = <span class="built_in">require</span>(<span class="string">'lowdb/adapters/FileSync'</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> adapter = <span class="keyword">new</span> FileSync(<span class="string">'db.json'</span>); <span class="comment">// 存储到db.json文件中</span></span><br><span class="line"><span class="keyword">const</span> db = low(adapter);	</span><br><span class="line"></span><br><span class="line"><span class="comment">// 设置一些默认值</span></span><br><span class="line">db.defaults(&#123;<span class="attr">posts</span>: [], <span class="attr">user</span>: &#123;&#125;&#125;).write();</span><br><span class="line"></span><br><span class="line"><span class="comment">// 添加一个post</span></span><br><span class="line">db.get(<span class="string">'posts'</span>).push(&#123;<span class="attr">id</span>: <span class="number">1</span>, <span class="attr">title</span>: <span class="string">'lowdb is awesome'</span>&#125;).write();</span><br><span class="line"></span><br><span class="line"><span class="comment">// 使用Lodash简写语法设置用户</span></span><br><span class="line">db.set(<span class="string">'user.name'</span>, <span class="string">'typicode'</span>).write();</span><br></pre></td></tr></table></figure>
<p>数据保存到db.json<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  <span class="string">"posts"</span>: [</span><br><span class="line">    &#123; <span class="string">"id"</span>: <span class="number">1</span>, <span class="string">"title"</span>: <span class="string">"lowdb is awesome"</span>&#125;</span><br><span class="line">  ],</span><br><span class="line">  <span class="string">"user"</span>: &#123;</span><br><span class="line">    <span class="string">"name"</span>: <span class="string">"typicode"</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>你可以使用任何 <a href="https://lodash.com/docs" target="_blank" rel="noopener">lodash</a> 函数 <a href="https://lodash.com/docs#get" target="_blank" rel="noopener">_.get</a> 和 <a href="https://lodash.com/docs#find" target="_blank" rel="noopener">_.find</a> 简写语法</p>
<a id="more"></a>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 如果您只是从db读取，请使用.value（）而不是.write（）</span></span><br><span class="line">db.get(<span class="string">'posts'</span>).find(&#123;<span class="attr">id</span>: <span class="number">1</span>&#125;).value();</span><br></pre></td></tr></table></figure>
<blockquote>
<p>Lowdb 非常适合 CLI，小型服务器，Electron 应用程序和 npm 软件包。</p>
</blockquote>
<p>它支持Node，浏览器并使用lodash API，因此学习起来非常简单。实际上，如果你知道Lodash，你已经知道如何使用lowdb</p>
<ul>
<li>用法示例<ul>
<li><a href="https://github.com/typicode/lowdb/tree/master/examples#cli" target="_blank" rel="noopener">CLI</a></li>
<li><a href="https://github.com/typicode/lowdb/tree/master/examples#browser" target="_blank" rel="noopener">浏览器</a></li>
<li><a href="https://github.com/typicode/lowdb/tree/master/examples#server" target="_blank" rel="noopener">服务器</a></li>
<li><a href="https://github.com/typicode/lowdb/tree/master/examples#in-memory" target="_blank" rel="noopener">In-memory</a></li>
</ul>
</li>
<li><a href="https://jsfiddle.net/typicode/4kd7xxbu/" target="_blank" rel="noopener">JSFiddle实例</a></li>
</ul>
<p><strong>重要的</strong> lowdb 不支持群集，并且可能存在非常大的JSON文件（~200MB）的问题。</p>
<p>在 <a href="https://unpkg.com/" target="_blank" rel="noopener">unpkg</a> 上也可以使用UMD构建进行测试和快速原型设计：<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">&lt;script src=<span class="string">"https://unpkg.com/lodash@4/lodash.min.js"</span>&gt;&lt;/script&gt;</span><br><span class="line">&lt;script src=<span class="string">"https://unpkg.com/lowdb@0.17/dist/low.min.js"</span>&gt;&lt;/script&gt;</span><br><span class="line">&lt;script src=<span class="string">"https://unpkg.com/lowdb@0.17/dist/LocalStorage.min.js"</span>&gt;&lt;/script&gt;</span><br><span class="line">&lt;script&gt;</span><br><span class="line">  <span class="keyword">var</span> adapter = <span class="keyword">new</span> LocalStorage(<span class="string">'db'</span>)</span><br><span class="line">  <span class="keyword">var</span> db = low(adapter)</span><br><span class="line">&lt;<span class="regexp">/script&gt;</span></span><br></pre></td></tr></table></figure></p>
<h2 id="API"><a href="#API" class="headerlink" title="API"></a>API</h2><p>1.low(adapter)<br>返回具有下面描述的其他属性和函数的lodash <a href="https://lodash.com/docs/4.17.4#chain" target="_blank" rel="noopener">链</a></p>
<p>2.db.[…].write() db.[…].value()<br><code>write()</code> 是一个语法糖，用于调用 <code>value()</code> 和 <code>db.write()</code> 一行。<br>另一方面，<code>value()</code> 只是 <a href="https://lodash.com/docs/4.17.4#prototype-value" target="_blank" rel="noopener">_.protoype.value()</a> 并且应该用于执行不更改数据库状态的链。<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">db.set(<span class="string">'user.name'</span>, <span class="string">'typicode'</span>).write()</span><br><span class="line"><span class="comment">// 相当于</span></span><br><span class="line">db.set(<span class="string">'user.name'</span>, <span class="string">'typicode'</span>).value()</span><br><span class="line">db.write()</span><br></pre></td></tr></table></figure></p>
<p>3.db._<br>数据库lodash实例。使用它来添加自己的实用程序函数或第三方mixins，如 <a href="https://github.com/documentcloud/underscore-contrib" target="_blank" rel="noopener">underscore-contrib</a> 或 <a href="https://github.com/typicode/lodash-id" target="_blank" rel="noopener">lodash-id</a>。<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">db._.mixin(&#123;</span><br><span class="line">    second: <span class="function"><span class="keyword">function</span>(<span class="params">array</span>)</span>&#123;</span><br><span class="line">        <span class="keyword">return</span> array[<span class="number">1</span>]</span><br><span class="line">    &#125;</span><br><span class="line">&#125;)</span><br><span class="line">db.get(<span class="string">'posts'</span>).second().value()</span><br></pre></td></tr></table></figure></p>
<p>4.db.getState()<br>返回数据库状态<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">db.getState() <span class="comment">// &#123;posts:[...]&#125;</span></span><br></pre></td></tr></table></figure></p>
<p>5.db.setState(nweState)<br>替换数据库状态 db.json 内容没变<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> newState = &#123;&#125;</span><br><span class="line">db.setState(newState)</span><br></pre></td></tr></table></figure></p>
<p>6.db.write()<br>使用持久化数据库adapter.write（取决于adapter，可能会返回一个promise）。<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 使用 lowdb/adapter/FileSync  同步</span></span><br><span class="line">db.write()</span><br><span class="line"><span class="built_in">console</span>.log(<span class="string">'state has been saved'</span>); <span class="comment">// 状态已保存</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 使用lowdb/adapter/FileAsync</span></span><br><span class="line">db.write().then(<span class="function"><span class="params">()</span>=&gt;</span><span class="built_in">console</span>.log(<span class="string">'state has been saved'</span>))</span><br></pre></td></tr></table></figure></p>
<p>7.db.read()<br>使用storage.read选项读取源代码（取决于adapter，可能会返回一个promise）<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 使用 lowdb/FileSync</span></span><br><span class="line">db.read()</span><br><span class="line"><span class="built_in">console</span>.log(<span class="string">'State has been updated'</span>) <span class="comment">// 状态已更新</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 使用 lowdb/FileAsync</span></span><br><span class="line">db.read().then(<span class="function"><span class="params">()</span>=&gt;</span><span class="built_in">console</span>.log(<span class="string">'State has been updated'</span>))</span><br></pre></td></tr></table></figure></p>
<h2 id="apapter-API"><a href="#apapter-API" class="headerlink" title="apapter API"></a>apapter API</h2><p>请注意，这仅适用于与Lowdb捆绑在一起的适配器。第三方适配器可能有不同的选项。</p>
<p>为了方便，<code>FileSync</code>，<code>FileAsync</code> 和 <code>LocalBrowser</code> 接受以下选项：</p>
<ul>
<li>defaultValue 如果文件不存在，则该值将被用于设定初始状态（default：<code>{}</code>）</li>
<li>serialize/deserialize 在写入之前和读取之后使用的函数（default：<code>JSON.stringify</code> 和 <code>JSON.parse</code> ） 序列化/反序列化<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> adapter = <span class="keyword">new</span> FileSync(<span class="string">'array.yaml'</span>, &#123;</span><br><span class="line">  defaultValue: [],</span><br><span class="line">  serialize: <span class="function">(<span class="params">array</span>) =&gt;</span> toYamlString(array),</span><br><span class="line">  deserialize: <span class="function">(<span class="params">string</span>) =&gt;</span> fromYamlString(string)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
</li>
</ul>
<h2 id="指南"><a href="#指南" class="headerlink" title="指南"></a>指南</h2><p>使用Lowdb，您可以访问整个lodash API，因此有很多方法来查询和操作数据</p>
<p>请注意，数据是通过引用返回的，这意味着对返回对象的修改可能会更改数据库。为了避免这种行为，您需要使用.cloneDeep().</p>
<p>此外，方法的执行是懒惰的，也就是说，延迟执行直到调用value()或.write()</p>
<h3 id="检查posts是否存在"><a href="#检查posts是否存在" class="headerlink" title="检查posts是否存在"></a>检查posts是否存在</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">db.has(<span class="string">'posts'</span>).value()</span><br></pre></td></tr></table></figure>
<h3 id="设置posts"><a href="#设置posts" class="headerlink" title="设置posts"></a>设置posts</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">db.set(<span class="string">'posts'</span>, []).write()</span><br></pre></td></tr></table></figure>
<h3 id="排序前五个-posts-文章"><a href="#排序前五个-posts-文章" class="headerlink" title="排序前五个 posts (文章)"></a>排序前五个 posts (文章)</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">db.get(<span class="string">'posts'</span>)</span><br><span class="line">	.filter(&#123;<span class="attr">published</span>: <span class="literal">true</span>&#125;)</span><br><span class="line">	.sortBy(<span class="string">'views'</span>)</span><br><span class="line">	.task(<span class="number">5</span>)</span><br><span class="line">	.value()</span><br></pre></td></tr></table></figure>
<h3 id="获取文章标题"><a href="#获取文章标题" class="headerlink" title="获取文章标题"></a>获取文章标题</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">db.get(<span class="string">'posts)</span></span><br><span class="line"><span class="string">	.map('</span>title<span class="string">')</span></span><br><span class="line"><span class="string">	.value()</span></span><br></pre></td></tr></table></figure>
<h3 id="获取文章数量"><a href="#获取文章数量" class="headerlink" title="获取文章数量"></a>获取文章数量</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">db.get(<span class="string">'posts'</span>)</span><br><span class="line">	.size()</span><br><span class="line">	.value()</span><br></pre></td></tr></table></figure>
<h3 id="使用路径获取第一篇文章的标题。"><a href="#使用路径获取第一篇文章的标题。" class="headerlink" title="使用路径获取第一篇文章的标题。"></a>使用路径获取第一篇文章的标题。</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">db.get(<span class="string">'posts[0].title'</span>)</span><br><span class="line">	.value()</span><br></pre></td></tr></table></figure>
<h3 id="更新一个post"><a href="#更新一个post" class="headerlink" title="更新一个post"></a>更新一个post</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">db.get(<span class="string">'posts'</span>)</span><br><span class="line">	.find(&#123;<span class="attr">title</span>: <span class="string">'low!'</span>&#125;)</span><br><span class="line">	.assign(&#123;<span class="attr">title</span>: <span class="string">'hi!'</span>&#125;)</span><br><span class="line">	.write()</span><br></pre></td></tr></table></figure>
<h3 id="删除-posts"><a href="#删除-posts" class="headerlink" title="删除 posts"></a>删除 posts</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">db.get(<span class="string">'posts'</span>)</span><br><span class="line">	.remove(&#123;<span class="attr">title</span>: <span class="string">'low!'</span>&#125;)</span><br><span class="line">	.write()</span><br></pre></td></tr></table></figure>
<h3 id="移除属性"><a href="#移除属性" class="headerlink" title="移除属性"></a>移除属性</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">db.unset(<span class="string">'user.name'</span>)</span><br><span class="line">	.write()</span><br></pre></td></tr></table></figure>
<h3 id="深克隆-posts"><a href="#深克隆-posts" class="headerlink" title="深克隆 posts"></a>深克隆 posts</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">db.get(<span class="string">'posts'</span>)</span><br><span class="line">	.cloneDeep()</span><br><span class="line">	.value()</span><br></pre></td></tr></table></figure>
<h2 id="如何使用基于id的资源"><a href="#如何使用基于id的资源" class="headerlink" title="如何使用基于id的资源"></a>如何使用基于id的资源</h2><p>能够使用id获取数据非常有用，尤其是在服务器中。要向lowdb添加基于id的资源支持，您有2个选项</p>
<ol>
<li><a href="https://github.com/dylang/shortid" target="_blank" rel="noopener">shortid</a> 更简约，并返回一个可在创建资源时使用的唯一ID。<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> shortid = <span class="built_in">require</span>(<span class="string">'shortid'</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> postId = db</span><br><span class="line"> .get(<span class="string">'posts'</span>)</span><br><span class="line"> .push(&#123; <span class="attr">id</span>: shortid.generate(), <span class="attr">title</span>: <span class="string">'low!'</span> &#125;)</span><br><span class="line"> .write()</span><br><span class="line"> .id</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> post = db</span><br><span class="line"> .get(<span class="string">'posts'</span>)</span><br><span class="line"> .find(&#123; <span class="attr">id</span>: postId &#125;)</span><br><span class="line"> .value()</span><br></pre></td></tr></table></figure>
</li>
</ol>
<ol>
<li><a href="https://github.com/typicode/lodash-id" target="_blank" rel="noopener">lodash-id</a> 提供了一组帮助程序，用于创建和操作基于id的资源。<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> lodashId = <span class="built_in">require</span>(<span class="string">'lodash-id'</span>)</span><br><span class="line"><span class="keyword">const</span> db = low(<span class="string">'db.json'</span>)</span><br><span class="line"></span><br><span class="line">db._.mixin(lodashId)</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> post = db</span><br><span class="line"> .get(<span class="string">'posts'</span>)</span><br><span class="line"> .insert(&#123; <span class="attr">title</span>: <span class="string">'low!'</span> &#125;)</span><br><span class="line"> .write()</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> post = db</span><br><span class="line"> .get(<span class="string">'posts'</span>)</span><br><span class="line"> .getById(post.id)</span><br><span class="line"> .value(</span><br></pre></td></tr></table></figure>
</li>
</ol>
<h2 id="如何创建自定义的适配器"><a href="#如何创建自定义的适配器" class="headerlink" title="如何创建自定义的适配器"></a>如何创建自定义的适配器</h2><p><code>low()</code> 接受自定义适配器，因此您可以使用任何格式将数据虚拟地保存到任何存储。<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span>   </span>&#123; </span><br><span class="line">  <span class="keyword">constructor</span> （） &#123; </span><br><span class="line">    <span class="comment">//  ...</span></span><br><span class="line">  &#125;</span><br><span class="line"> </span><br><span class="line">  read （） &#123; </span><br><span class="line">    <span class="comment">//  应返回数据（对象或数组）或Promise</span></span><br><span class="line">  &#125;</span><br><span class="line"> </span><br><span class="line">  write(data)&#123; </span><br><span class="line">    <span class="comment">//  不应该返回任何内容或Promise</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">const</span> adapter = <span class="keyword">new</span> MyStorage（ args ）    </span><br><span class="line"><span class="keyword">const</span> db = low （）</span><br></pre></td></tr></table></figure></p>
<p>See <a href="https://github.com/typicode/lowdb/blob/HEAD/src/adapters" target="_blank" rel="noopener">src/adapters</a> for examples. 查看例子</p>
<h2 id="如何加密数据"><a href="#如何加密数据" class="headerlink" title="如何加密数据"></a>如何加密数据</h2><p><code>FileSync</code>，<code>FileAsync</code> 和 <code>LocalStorage</code> 接受自定义 <code>serialize</code> 和 <code>deserialize</code> 功能。您可以使用它们来添加加密逻辑。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> adapter = <span class="keyword">new</span> FileSync(<span class="string">'db.json'</span>, &#123;</span><br><span class="line">  serialize: <span class="function">(<span class="params">data</span>) =&gt;</span> encrypt(<span class="built_in">JSON</span>.stringify(data))  <span class="comment">// 加密</span></span><br><span class="line">  deserialize: <span class="function">(<span class="params">data</span>) =&gt;</span> <span class="built_in">JSON</span>.parse(decrypt(data))  <span class="comment">// 解密</span></span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
]]></content>
    
    <summary type="html">
    
      &lt;p&gt;NPM 源地址 ： &lt;a href=&quot;https://www.npmjs.com/package/lowdb&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;https://www.npmjs.com/package/lowdb&lt;/a&gt;&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;用于Node，Electron和浏览器的小型JSON数据库。由Lodash提供技术支持&lt;/p&gt;
&lt;/blockquote&gt;
&lt;figure class=&quot;highlight javascript&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;db.get(&lt;span class=&quot;string&quot;&gt;&#39;posts&#39;&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  .push(&amp;#123; &lt;span class=&quot;attr&quot;&gt;id&lt;/span&gt;: &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;, &lt;span class=&quot;attr&quot;&gt;title&lt;/span&gt;: &lt;span class=&quot;string&quot;&gt;&#39;lowdb is awesome&#39;&lt;/span&gt;&amp;#125;)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  .write()&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;h2 id=&quot;用法&quot;&gt;&lt;a href=&quot;#用法&quot; class=&quot;headerlink&quot; title=&quot;用法&quot;&gt;&lt;/a&gt;用法&lt;/h2&gt;&lt;figure class=&quot;highlight plain&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;npm install lowdb&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;figure class=&quot;highlight javascript&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;14&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; low = &lt;span class=&quot;built_in&quot;&gt;require&lt;/span&gt;(&lt;span class=&quot;string&quot;&gt;&#39;lowdb&#39;&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; FileSync = &lt;span class=&quot;built_in&quot;&gt;require&lt;/span&gt;(&lt;span class=&quot;string&quot;&gt;&#39;lowdb/adapters/FileSync&#39;&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; adapter = &lt;span class=&quot;keyword&quot;&gt;new&lt;/span&gt; FileSync(&lt;span class=&quot;string&quot;&gt;&#39;db.json&#39;&lt;/span&gt;); &lt;span class=&quot;comment&quot;&gt;// 存储到db.json文件中&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;const&lt;/span&gt; db = low(adapter);	&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;// 设置一些默认值&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;db.defaults(&amp;#123;&lt;span class=&quot;attr&quot;&gt;posts&lt;/span&gt;: [], &lt;span class=&quot;attr&quot;&gt;user&lt;/span&gt;: &amp;#123;&amp;#125;&amp;#125;).write();&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;// 添加一个post&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;db.get(&lt;span class=&quot;string&quot;&gt;&#39;posts&#39;&lt;/span&gt;).push(&amp;#123;&lt;span class=&quot;attr&quot;&gt;id&lt;/span&gt;: &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;, &lt;span class=&quot;attr&quot;&gt;title&lt;/span&gt;: &lt;span class=&quot;string&quot;&gt;&#39;lowdb is awesome&#39;&lt;/span&gt;&amp;#125;).write();&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;// 使用Lodash简写语法设置用户&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;db.set(&lt;span class=&quot;string&quot;&gt;&#39;user.name&#39;&lt;/span&gt;, &lt;span class=&quot;string&quot;&gt;&#39;typicode&#39;&lt;/span&gt;).write();&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;数据保存到db.json&lt;br&gt;&lt;figure class=&quot;highlight javascript&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;string&quot;&gt;&quot;posts&quot;&lt;/span&gt;: [&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &amp;#123; &lt;span class=&quot;string&quot;&gt;&quot;id&quot;&lt;/span&gt;: &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;, &lt;span class=&quot;string&quot;&gt;&quot;title&quot;&lt;/span&gt;: &lt;span class=&quot;string&quot;&gt;&quot;lowdb is awesome&quot;&lt;/span&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  ],&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;string&quot;&gt;&quot;user&quot;&lt;/span&gt;: &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;string&quot;&gt;&quot;name&quot;&lt;/span&gt;: &lt;span class=&quot;string&quot;&gt;&quot;typicode&quot;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;p&gt;你可以使用任何 &lt;a href=&quot;https://lodash.com/docs&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;lodash&lt;/a&gt; 函数 &lt;a href=&quot;https://lodash.com/docs#get&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;_.get&lt;/a&gt; 和 &lt;a href=&quot;https://lodash.com/docs#find&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;_.find&lt;/a&gt; 简写语法&lt;/p&gt;
    
    </summary>
    
    
      <category term="lowdb" scheme="https://shizhonghai.github.io/tags/lowdb/"/>
    
  </entry>
  
  <entry>
    <title>关于 GitHub 相关技巧</title>
    <link href="https://shizhonghai.github.io/2020/01/15/github/"/>
    <id>https://shizhonghai.github.io/2020/01/15/github/</id>
    <published>2020-01-14T16:00:00.000Z</published>
    <updated>2020-01-15T08:59:50.405Z</updated>
    
    <content type="html"><![CDATA[<h2 id="显示-GitHub-Stars-数量-官方文档地址：https-shields-io"><a href="#显示-GitHub-Stars-数量-官方文档地址：https-shields-io" class="headerlink" title="显示 GitHub Stars 数量 (官方文档地址：https://shields.io/)"></a>显示 GitHub Stars 数量 (官方文档地址：<a href="https://shields.io/" target="_blank" rel="noopener">https://shields.io/</a>)</h2><p><a href="https://github.com/louzhedong/blog/stargazers" target="_blank" rel="noopener"><img src="https://img.shields.io/github/stars/louzhedong/blog.svg?style=social" alt="GitHub stars"></a></p>
<p><a href="https://github.com/shizhonghai/shizhonghai.github.io/stargazers" target="_blank" rel="noopener"><img src="https://img.shields.io/github/stars/shizhonghai/shizhonghai.github.io?style=social" alt="GitHub stars"></a></p>
]]></content>
    
    <summary type="html">
    
      &lt;h2 id=&quot;显示-GitHub-Stars-数量-官方文档地址：https-shields-io&quot;&gt;&lt;a href=&quot;#显示-GitHub-Stars-数量-官方文档地址：https-shields-io&quot; class=&quot;headerlink&quot; title=&quot;显示 GitHu
    
    </summary>
    
    
      <category term="Github" scheme="https://shizhonghai.github.io/tags/Github/"/>
    
  </entry>
  
  <entry>
    <title>git 忽略规则以及 .gitignore 文件不生效解决办法</title>
    <link href="https://shizhonghai.github.io/2020/01/07/gitignore/"/>
    <id>https://shizhonghai.github.io/2020/01/07/gitignore/</id>
    <published>2020-01-06T16:00:00.000Z</published>
    <updated>2020-01-07T07:50:49.369Z</updated>
    
    <content type="html"><![CDATA[<h2 id="Git-忽略规则"><a href="#Git-忽略规则" class="headerlink" title="Git 忽略规则"></a>Git 忽略规则</h2><p>#此为注释 – 内容被 Git 忽略</p>
<ul>
<li>.sample 　　    # 忽略所有 .sample 结尾的文件</li>
<li>!lib.sample 　　# 但 lib.sample 除外</li>
<li>/TODO 　　      # 仅仅忽略项目根目录下的 TODO 文件，不包括 subdir/TODO</li>
<li>build/ 　　     # 忽略 build/ 目录下的所有文件</li>
<li>doc/.txt 　　   # 会忽略 doc/notes.txt 但不包括 doc/server/arch.txt</li>
</ul>
<h2 id="gitignore-规则不生效的解决办法"><a href="#gitignore-规则不生效的解决办法" class="headerlink" title=".gitignore 规则不生效的解决办法"></a>.gitignore 规则不生效的解决办法</h2><p>把某些目录或文件加入忽略规则，按照上述方法定义后发现并未生效，原因是.gitignore只能忽略那些原来没有被追踪的文件，如果某些文件已经被纳入了版本管理中，则修改.gitignore是无效的。那么解决方法就是先把本地缓存删除（改变成未被追踪状态），然后再提交</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">git rm -rf --cached .</span><br><span class="line">git add .</span><br><span class="line">git commit -m &apos;update .gitignore&apos;</span><br></pre></td></tr></table></figure>
]]></content>
    
    <summary type="html">
    
      &lt;h2 id=&quot;Git-忽略规则&quot;&gt;&lt;a href=&quot;#Git-忽略规则&quot; class=&quot;headerlink&quot; title=&quot;Git 忽略规则&quot;&gt;&lt;/a&gt;Git 忽略规则&lt;/h2&gt;&lt;p&gt;#此为注释 – 内容被 Git 忽略&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;.sample 　　    
    
    </summary>
    
    
      <category term="git" scheme="https://shizhonghai.github.io/tags/git/"/>
    
  </entry>
  
  <entry>
    <title>每日一题（2019-10-29）</title>
    <link href="https://shizhonghai.github.io/2019/12/12/Daily-Interview-Question-2/"/>
    <id>https://shizhonghai.github.io/2019/12/12/Daily-Interview-Question-2/</id>
    <published>2019-12-11T16:00:00.000Z</published>
    <updated>2019-12-12T02:06:34.331Z</updated>
    
    <content type="html"><![CDATA[<h2 id="第-0002-题：Vue-中的-computed-和-watch-的区别在哪里"><a href="#第-0002-题：Vue-中的-computed-和-watch-的区别在哪里" class="headerlink" title="第 0002 题：Vue 中的 computed 和 watch 的区别在哪里"></a>第 0002 题：Vue 中的 computed 和 watch 的区别在哪里</h2><p><code>computed</code>：计算属性</p>
<ul>
<li>计算属性是由 <code>data</code> 中的已知值，得到的一个新值。</li>
<li>这个新值只会根据已知值的变化而变化，其他不相关的数据的变化不会影响该新值。</li>
<li>计算属性不在 <code>data</code> 中，计算属性新值的相关已知值在 <code>data</code> 中。</li>
<li>具有缓存性，页面重新渲染值不变化,计算属性会立即返回之前的计算结果，而不必再次执行函数。</li>
<li>别人变化影响我自己。</li>
</ul>
<p><code>watch</code>：监听数据的变化</p>
<ul>
<li>监听data中数据的变化。</li>
<li>监听的数据就是data中的已知值。</li>
<li>无缓存性，页面重新渲染时值不变化也会执行。</li>
<li>我的变化影响别人。</li>
</ul>
<p>公司：虾皮</p>
<blockquote>
<ol>
<li><code>watch</code> 擅长处理的场景：一个数据影响多个数据</li>
<li><code>computed</code> 擅长处理的场景：一个数据受多个数据影响</li>
</ol>
</blockquote>
]]></content>
    
    <summary type="html">
    
      &lt;h2 id=&quot;第-0002-题：Vue-中的-computed-和-watch-的区别在哪里&quot;&gt;&lt;a href=&quot;#第-0002-题：Vue-中的-computed-和-watch-的区别在哪里&quot; class=&quot;headerlink&quot; title=&quot;第 0002 题：Vue 中
    
    </summary>
    
    
      <category term="每日一题" scheme="https://shizhonghai.github.io/tags/%E6%AF%8F%E6%97%A5%E4%B8%80%E9%A2%98/"/>
    
  </entry>
  
  <entry>
    <title>每日一题（2019-11-01）</title>
    <link href="https://shizhonghai.github.io/2019/12/12/Daily-Interview-Question-3/"/>
    <id>https://shizhonghai.github.io/2019/12/12/Daily-Interview-Question-3/</id>
    <published>2019-12-11T16:00:00.000Z</published>
    <updated>2019-12-12T06:35:13.082Z</updated>
    
    <content type="html"><![CDATA[<h2 id="第-0003-题：webpack-中-loader-和-plugin-的区别是什么"><a href="#第-0003-题：webpack-中-loader-和-plugin-的区别是什么" class="headerlink" title="第 0003 题：webpack 中 loader 和 plugin 的区别是什么"></a>第 0003 题：webpack 中 loader 和 plugin 的区别是什么</h2><p><code>loader</code> 它是一个转换器，将 A 文件进行编译成 B 文件，比如：将 A.less 转换为 A.css，单纯的文件转换过程。<br><code>plugin</code> 是一个扩展器，它丰富了 <code>webpack</code> 本身，针对是 <code>loader</code> 结束后，<code>webpack</code> 打包的整个过程，它并不直接操作文件，而是基于事件机制工作，会监听 <code>webpack</code> 打包过程中的某些节点，执行广泛的任务</p>
<p>公司：平安</p>
]]></content>
    
    <summary type="html">
    
      &lt;h2 id=&quot;第-0003-题：webpack-中-loader-和-plugin-的区别是什么&quot;&gt;&lt;a href=&quot;#第-0003-题：webpack-中-loader-和-plugin-的区别是什么&quot; class=&quot;headerlink&quot; title=&quot;第 0003 题：w
    
    </summary>
    
    
      <category term="每日一题" scheme="https://shizhonghai.github.io/tags/%E6%AF%8F%E6%97%A5%E4%B8%80%E9%A2%98/"/>
    
  </entry>
  
  <entry>
    <title>解决 Hexo Cannot find module &#39;./build/Release/DTraceProviderBindings&#39; 错误</title>
    <link href="https://shizhonghai.github.io/2019/12/12/hexo-error-DTraceProviderBindings/"/>
    <id>https://shizhonghai.github.io/2019/12/12/hexo-error-DTraceProviderBindings/</id>
    <published>2019-12-11T16:00:00.000Z</published>
    <updated>2019-12-12T06:59:06.403Z</updated>
    
    <content type="html"><![CDATA[<h2 id="hexo-报错"><a href="#hexo-报错" class="headerlink" title="hexo 报错"></a>hexo 报错</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Error: Cannot find module &apos;./build/Release/DTraceProviderBindings&apos;</span><br></pre></td></tr></table></figure>
<h2 id="解决办法-on-google"><a href="#解决办法-on-google" class="headerlink" title="解决办法 on google"></a>解决办法 on google</h2><p>google之后发现被这个问题困扰的小伙伴还真不少，网上最靠谱的解决办法是：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ npm install hexo --no-optional</span><br></pre></td></tr></table></figure>
<p>的确很多小伙伴执行上面的命令之后都解决了报错的问题，但也有很多小伙伴跟我一样执行后没有任何效果，我甚至尝试了卸载后重装的方式：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$ npm uninstall hexo</span><br><span class="line">$ npm install hexo --no-optional</span><br></pre></td></tr></table></figure>
<p>可是依旧没有效果。<br>其实 hexo 暂时并没有用到 <code>dtrace-prodider</code> ，仅仅是报错而已，hexo 的命令还是能执行，但对于强迫症来说，简直无法忍受。</p>
<p>我的解决办法<br>一番折腾之后，我找到了适合我的解决办法，重装 <code>hexo-cli</code>，如果命令行报没权限错误，请记得前面加 <code>sudo</code> :</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$ npm uninstall hexo-cli -g</span><br><span class="line">$ npm install hexo-cli -g</span><br></pre></td></tr></table></figure>
<p>再来执行 hexo 命令果然没有报错信息了:D</p>
]]></content>
    
    <summary type="html">
    
      &lt;h2 id=&quot;hexo-报错&quot;&gt;&lt;a href=&quot;#hexo-报错&quot; class=&quot;headerlink&quot; title=&quot;hexo 报错&quot;&gt;&lt;/a&gt;hexo 报错&lt;/h2&gt;&lt;figure class=&quot;highlight plain&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=
    
    </summary>
    
    
      <category term="hexo" scheme="https://shizhonghai.github.io/tags/hexo/"/>
    
  </entry>
  
  <entry>
    <title>自定义 Echarts 图表悬浮框的位置</title>
    <link href="https://shizhonghai.github.io/2019/08/12/echarts-tooltip/"/>
    <id>https://shizhonghai.github.io/2019/08/12/echarts-tooltip/</id>
    <published>2019-08-11T16:00:00.000Z</published>
    <updated>2019-08-12T09:54:08.811Z</updated>
    
    <content type="html"><![CDATA[<p>由于项目需求，悬浮框内容较多，会出现悬浮框(tooltip)很长或者很宽的现象，而太长了，就会被 Echarts 溢出隐藏了，所以需要自定义定位需求</p>
<blockquote>
<p>需求描述：鼠标悬浮在左侧某一个点时，悬浮框悬停在点的右侧；鼠标悬停在右侧某一个点时，悬浮框悬停在点的左侧。</p>
</blockquote>
<p>首先明确一点，我们需要借助 <code>tooltip.position</code> 属性。理想的思路是我们在回调函数中获取鼠标每次悬停的坐标，然后再判断这个坐标是否处于此容器(也就是这个Echarts图表)的左侧或者右侧；判断命中后我们再改变 <code>tooltip</code> 的位置，并返回给函数。</p>
<a id="more"></a>
<p>效果图：【左侧悬浮】<br><img src="/images/echart_01@2x.png" alt="左侧悬浮"></p>
<p>效果图：【右侧悬浮】<br><img src="/images/echart_02@2x.png" alt="左侧悬浮"></p>
<p>效果图：【溢出显示】<br><img src="/images/echart_03@2x.png" alt="溢出显示"></p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 关健代码</span></span><br><span class="line">tooltip: &#123;</span><br><span class="line">    position: <span class="function"><span class="keyword">function</span> (<span class="params">position</span>) </span>&#123;</span><br><span class="line">        <span class="keyword">let</span> dom = <span class="built_in">document</span>.getElementById(<span class="string">'chartDom'</span>);</span><br><span class="line">        <span class="keyword">if</span> (dom) &#123;</span><br><span class="line">            <span class="comment">// 获取容器的宽度</span></span><br><span class="line">            <span class="keyword">let</span> chartsWidth = dom.offsetWidth;</span><br><span class="line">            <span class="comment">// 判断悬停点落在容器的哪测</span></span><br><span class="line">            <span class="keyword">if</span> (position[<span class="number">0</span>] &lt; (chartsWidth / <span class="number">2</span>)) &#123;</span><br><span class="line">                position[<span class="number">0</span>] = position[<span class="number">0</span>];</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                position[<span class="number">0</span>] = position[<span class="number">0</span>] - <span class="number">130</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> [position[<span class="number">0</span>], position[<span class="number">1</span>]];</span><br><span class="line">    &#125;    </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;由于项目需求，悬浮框内容较多，会出现悬浮框(tooltip)很长或者很宽的现象，而太长了，就会被 Echarts 溢出隐藏了，所以需要自定义定位需求&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;需求描述：鼠标悬浮在左侧某一个点时，悬浮框悬停在点的右侧；鼠标悬停在右侧某一个点时，悬浮框悬停在点的左侧。&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;首先明确一点，我们需要借助 &lt;code&gt;tooltip.position&lt;/code&gt; 属性。理想的思路是我们在回调函数中获取鼠标每次悬停的坐标，然后再判断这个坐标是否处于此容器(也就是这个Echarts图表)的左侧或者右侧；判断命中后我们再改变 &lt;code&gt;tooltip&lt;/code&gt; 的位置，并返回给函数。&lt;/p&gt;
    
    </summary>
    
    
      <category term="Echarts" scheme="https://shizhonghai.github.io/tags/Echarts/"/>
    
  </entry>
  
</feed>
